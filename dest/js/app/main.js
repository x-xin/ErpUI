define("core/cncnERP",[],function(){"use strict";return function(){String.prototype.getLength=function(){return this.replace(/[^\x00-\xff]/g,"en").length},String.prototype.trims=function(){return this.replace(/^[\s\xa0\u3000]+|[\u3000\xa0\s]+$/g,"")},String.prototype.toUnicode=function(){return escape(this.toLocaleLowerCase().replace(/%u/gi,"\\"))},String.prototype.unicodeTo=function(){return unescape(this.toLocaleLowerCase().replace(/%u/gi,"\\"))},String.prototype.format=function(e){var t=new Date(this),n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in n)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[a]:("00"+n[a]).substr((""+n[a]).length)));return e},String.prototype.getZoneName=function(){if(window.zoneData)return zoneData[this]},Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},window.console||(window.console={}),console.log||(console.log=function(){});var e=window.saogaUI||{};e={_INSTALL:function(){window.saogaUI=e},base:{},ui:{},app:{}},e._INSTALL()}(window),saogaUI.base={isArray:function(e){return!!e&&jQuery.isArray(e)},isObject:function(e){return!!e&&"[object Object]"===Object.prototype.toString.call(e)},isFunction:function(e){return!!e&&"[object Function]"===Object.prototype.toString.call(e)},browser:function(){var e=window.navigator,t=/(msie|webkit|gecko|presto|opera|safari|firefox|chrome|maxthon|android|ipad|iphone|webos|hpwos)[ \/os]*([\d_.]+)/gi,n=e.userAgent.toLowerCase(),a={platform:e.platform};if(n.replace(t,function(e,t,n){var i=t.toLowerCase();a[i]||(a[i]=n)}),a.msie){a.ie=a.msie;var i=parseInt(a.msie,10);a["ie"+i]=!0}return a}(),cookie:{set:function(e,t,n,a,i){if(n){var o=new Date,r=new Date;r.setTime(o.getTime()+36e5*n)}return document.cookie=e+"="+encodeURI(t)+"; "+(n?"expires="+r.toGMTString()+"; ":"")+(i?"path="+i+"; ":"path=/; ")+(a?"domain="+a+";":""),!0},get:function(e){var t=new RegExp("(?:^|;+|\\s+)"+e+"=([^;]*)"),n=document.cookie.match(t);return unescape(decodeURI(n?n[1]:""))},del:function(e,t,n){document.cookie=e+"=; expires=Mon, 26 Jul 1997 05:00:00 GMT; "+(n?"path="+n+"; ":"path=/; ")+(t?"domain="+t+";":"")}}},saogaUI.ui={zIndex:function(){return 99999+$(".l-ui").length},wrap:function(){return $("#l-ui-wrap").length||$("body").append('<div id="l-ui-wrap"><!--[if lte IE 6.5]><iframe src="javascript:false;" style="width:0;height:0;"></iframe><![endif]--></div>'),$("#l-ui-wrap")},noScroll:function(){var e=$("html");void 0===document.onmousewheel?e[0].addEventListener("DOMMouseScroll",function(t){e.scrollTop+=t.detail>0?60:-60},!1):e.onmousewheel=function(t){t=t||window.event,e.scrollTop+=t.wheelDelta>0?-60:60,t.returnValue=!1},e.addClass("html-noScroll")},lock:function(){var e=$(window),t=$("body"),n=$(".l-ui-lock"),a=function(){n.length||(n=t.append('<div class="l-ui-lock fn-hide"></div>').find(".l-ui-lock")),n.css({filter:"Alpha(opacity=20)",width:"100%",height:t[0].scrollHeight})};return this.noScroll(),a(),e.resize(a),n.fadeIn(),n},unlock:function(){$("html").removeClass("html-noScroll"),$(".l-ui-lock").fadeOut()},mousePosition:function(e){e=e||window.event;var t=e.pageX||e.clientX+document.body.scrollLeft,n=e.pageY||e.clientY+document.body.scrollTop;return{positionX:t,positionY:n}},widescreen:function(){return screen.width>=1210}(),onselectstart:function(e){return!(!e||!e.length)&&(void 0!==document.onselectstart?e[0].onselectstart=function(){return!1}:e.css({"-moz-user-select":"none"}),e)}},saogaUI}),!function(){function e(e){return e.replace(w,"").replace(x,",").replace(y,"").replace(k,"").replace(C,"").split(/^$|,+/)}function t(e){return"'"+e.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function n(n,a){function i(e){return p+=e.split(/\n/).length-1,d&&(e=e.replace(/[\n\r\t\s]+/g," ").replace(/<!--.*?-->/g,"")),e&&(e=b[1]+t(e)+b[2]+"\n"),e}function o(t){var n=p;if(c?t=c(t,a):r&&(t=t.replace(/\n/g,function(){return p++,"$line="+p+";"})),0===t.indexOf("=")){var i=u&&!/^=[=#]/.test(t);if(t=t.replace(/^=[=#]?|[\s;]*$/g,""),i){var o=t.replace(/\s*\([^\)]+\)/,"");f[o]||/^(include|print)$/.test(o)||(t="$escape("+t+")")}else t="$string("+t+")";t=b[1]+t+b[2]}return r&&(t="$line="+n+";"+t),m(e(t),function(e){if(e&&!g[e]){var t;t="print"===e?x:"include"===e?y:f[e]?"$utils."+e:h[e]?"$helpers."+e:"$data."+e,k+=e+"="+t+",",g[e]=!0}}),t+"\n"}var r=a.debug,l=a.openTag,s=a.closeTag,c=a.parser,d=a.compress,u=a.escape,p=1,g={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},v="".trim,b=v?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],w=v?"$out+=text;return $out;":"$out.push(text);",x="function(){var text=''.concat.apply('',arguments);"+w+"}",y="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+w+"}",k="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(r?"$line=0,":""),C=b[0],S="return new String("+b[3]+");";m(n.split(l),function(e){e=e.split(s);var t=e[0],n=e[1];1===e.length?C+=i(t):(C+=o(t),n&&(C+=i(n)))});var j=k+C+S;r&&(j="try{"+j+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+t(n)+".split(/\\n/)[$line-1].replace(/^[\\s\\t]+/,'')};}");try{var $=new Function("$data","$filename",j);return $.prototype=f,$}catch(e){throw e.temp="function anonymous($data,$filename) {"+j+"}",e}}var a=function(e,t){return"string"==typeof t?v(t,{filename:e}):r(e,t)};a.version="3.0.0",a.config=function(e,t){i[e]=t};var i=a.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},o=a.cache={};a.render=function(e,t){return v(e,t)};var r=a.renderFile=function(e,t){var n=a.get(e)||g({filename:e,name:"Render Error",message:"Template not found"});return t?n(t):n};a.get=function(e){var t;if(o[e])t=o[e];else if("object"==typeof document){var n=document.getElementById(e);if(n){var a=(n.value||n.innerHTML).replace(/^\s*|\s*$/g,"");t=v(a,{filename:e})}}return t};var l=function(e,t){return"string"!=typeof e&&(t=typeof e,"number"===t?e+="":e="function"===t?l(e.call(e)):""),e},s={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},c=function(e){return s[e]},d=function(e){return l(e).replace(/&(?![\w#]+;)|[<>"']/g,c)},u=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},p=function(e,t){var n,a;if(u(e))for(n=0,a=e.length;a>n;n++)t.call(e,e[n],n,e);else for(n in e)t.call(e,e[n],n)},f=a.utils={$helpers:{},$include:r,$string:l,$escape:d,$each:p};a.helper=function(e,t){h[e]=t};var h=a.helpers=f.$helpers;a.onerror=function(e){var t="Template Error\n\n";for(var n in e)t+="<"+n+">\n"+e[n]+"\n\n";"object"==typeof console&&console.error(t)};var g=function(e){return a.onerror(e),function(){return"{Template Error}"}},v=a.compile=function(e,t){function a(n){try{return new s(n,l)+""}catch(a){return t.debug?g(a)():(t.debug=!0,v(e,t)(n))}}t=t||{};for(var r in i)void 0===t[r]&&(t[r]=i[r]);var l=t.filename;try{var s=n(e,t)}catch(e){return e.filename=l||"anonymous",e.name="Syntax Error",g(e)}return a.prototype=s.prototype,a.toString=function(){return s.toString()},l&&t.cache&&(o[l]=a),a},m=f.$each,b="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",w=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,x=/[^\w$]+/g,y=new RegExp(["\\b"+b.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),k=/^\d[^,]*|,\d[^,]*/g,C=/^,+|,+$/g;i.openTag="{{",i.closeTag="}}";var S=function(e,t){var n=t.split(":"),a=n.shift(),i=n.join(":")||"";return i&&(i=", "+i),"$helpers."+a+"("+e+i+")"};i.parser=function(e,t){e=e.replace(/^\s/,"");var n=e.split(" "),i=n.shift(),o=n.join(" ");switch(i){case"if":e="if("+o+"){";break;case"else":n="if"===n.shift()?" if("+n.join(" ")+")":"",e="}else"+n+"{";break;case"/if":e="}";break;case"each":var r=n[0]||"$data",l=n[1]||"as",s=n[2]||"$value",c=n[3]||"$index",d=s+","+c;"as"!==l&&(r="[]"),e="$each("+r+",function("+d+"){";break;case"/each":e="});";break;case"echo":e="print("+o+");";break;case"print":case"include":e=i+"("+n.join(",")+");";break;default:if(-1!==o.indexOf("|")){var u=t.escape;0===e.indexOf("#")&&(e=e.substr(1),u=!1);for(var p=0,f=e.split("|"),h=f.length,g=u?"$escape":"$string",v=g+"("+f[p++]+")";h>p;p++)v=S(v,f[p]);e="=#"+v}else e=a.helpers[i]?"=#"+i+"("+n.join(",")+");":"="+e}return e},"function"==typeof define?define("template",[],function(){return a}):"undefined"!=typeof exports?module.exports=a:this.template=a}(),define("core/validator",["core/cncnERP"],function(e){"use strict";var t=function(t){var n=this,a={target:null,label:null,text:{check:"必须勾选！",required:"不能为空！",select:"请选择！",length:"输入字符长度等于{{param}}个字符",minLength:"输入字符长度不小于{{param}}个字符",maxLength:"输入字符长度大小于{{param}}个字符",minValue:"请输入不能小于{{param}}",maxValue:"请输入不能大于{{param}}",integer:"请输入一个正确的整数值",digits:"请输入一个正确的正整数",floatNumber:"请输入一个精确到{{param}}位小数的数值",number:"请输入一个正确的数字",email:"邮箱格式不正确，请检查！",mobile:"手机号码不正确，请检查！如：13412345678",phone:"电话号码不正确，请检查！如：0592-1234567或13412345678",url:"请输入正确的网址，比如:http://www.example.com",date:"",format:"",ajax:""},rules:null,ajax:null,position:null},i={rule:{check:function(e,t,n){return e=e.trims(),!!e.length&&(("checkbox"!==t[0].type||$("input:checkbox[name='"+t[0].name+"']:checked").length)&&("radio"!==t[0].type||$("input:radio[name='"+t[0].name+"']:checked").length)?void 0:i.handleText(t,"check"))},select:function(e,t,n){if(e===n)return i.handleText(t,"select",n)},required:function(e,t){if(!e.trims())return i.handleText(t,"required")},length:function(e,t,n){return e=e.trims(),!!e.length&&(e.length!==Number(n)?i.handleText(t,"length",n):void 0)},minLength:function(e,t,n){return e=e.trims(),!!e.length&&(e.length<n?i.handleText(t,"minLength",n):void 0)},maxLength:function(e,t,n){return e=e.trims(),!!e.length&&(e.length>n?i.handleText(t,"maxLength",n):void 0)},minValue:function(e,t,n){return e=Number(e),n=Number(n),!(e>=n)&&i.handleText(t,"minValue",n)},maxValue:function(e,t,n){return e=Number(e),n=Number(n),!(e<=n)&&i.handleText(t,"maxValue",n)},integer:function(e,t){var n=parseFloat(e);return e=e.trims(),!!e.length&&(isNaN(n)||n.toString()!==e||Math.round(n)!==n?i.handleText(t,"integer"):void 0)},digits:function(e,t){return e=e.trims(),!!e.length&&(0===Number(e)?i.handleText(t,"digits"):/^\d+$/.test(e)?void 0:i.handleText(t,"digits"))},floatNumber:function(e,t,n){var a=new RegExp("^[0-9]+[.][0-9]{"+n+"}$");return e=e.trims(),!!e.length&&(a.test(e)?void 0:i.handleText(t,"floatNumber",n))},number:function(e,t,n){var a=[],o="";return e=e.trims(),isNaN(Number(e))?i.handleText(t,"number"):n&&(a=n.split(":"),"float"===a[0]&&(o=new RegExp("^[0-9]([.][0-9]{1,"+a[1]+"})?$"),!o.test(e)))?i.handleText(t,"floatNumber",a[1]):void 0},email:function(e,t){return e=e.trims(),!!e.length&&(/\w{1,}[@][\w\-]{1,}([.]([\w\-]{1,})){1,3}$/.test(e)?void 0:i.handleText(t,"email"))},mobile:function(e,t){return e=e.trims(),!!e.length&&(/1[34578]{1}\d{9}$/.test(e)?void 0:i.handleText(t,"mobile"))},phone:function(e,t){return e=e.trims(),!!e.length&&(/(1[34578]{1}\d{9}$)|(0\d{2,3}-\d{7,8}(-\d{2,3})?$)/.test(e)?void 0:i.handleText(t,"phone"))},idCard:function(e,t){return e=e.trims(),!!e.length&&(/(^\d{15}$)|(^\d{17}([0-9]|X|x)$)/.test(e)?void 0:i.handleText(t,"idCard"))},url:function(e,t){return e=e.trims(),!!e.length&&(/^(http|https|ftp):\/\/(([A-Z0-9][A-Z0-9_-]*)(\.[A-Z0-9][A-Z0-9_-]*)+)(:(\d+))?\/?/i.test(e)?void 0:i.handleText(t,"url"))},date:function(e,t,n){var a=/^(\d{2})\/(\d{2})\/(\d{4})$/;if(!a.test(e))return!1;var i=new Date(e.replace(a,"$2/$1/$3"));return parseInt(RegExp.$2,10)===1+i.getMonth()&&parseInt(RegExp.$1,10)===i.getDate()&&parseInt(RegExp.$3,10)===i.getFullYear()},format:function(e,t,n){var a=new RegExp(n);return e=e.trims(),!!e.length&&(a.test(e)?void 0:i.handleText(t,"format"))},ajax:function(e,t,n){return e=e.trims(),!!e.length&&(t.addClass("l-form-error"),void $.ajax({type:"POST",url:n,cache:!1,dataType:"json",beforeSend:function(){},success:function(e){e?t.removeClass("l-form-error"):(t.addClass("l-form-error"),i.handleMessage(t,i.handleText(t,"ajax")))},error:function(e){console.log(e)}}))}},handlePositionStr:function(e){if(e){for(var t=e.replace(/\{|\}/g,""),n=t.split(","),a=n.length,i=0,o={};i<a;i++){var r=n[i].split(":");o[r[0]]=Number(r[1])}return o}},route:function(t){if(t.length){for(var n=this,a=t.val(),i=t.attr("data-validate").split(";"),o=i.length,r=0,l=/\=/,s=/format\=|ajax\=/,c=/\|/,d=e.base.isFunction;r<o;r++){var u=null,p="",f="",h="",g="";if(l.test(i[r])){var v=i[r].split("=");if(s)if("format"===v[0])v=["format",i[r].replace(s,"")];else{var m="";m=i[r].replace(s,""),m=m.replace(/{{value}}/,a),v=["ajax",m]}else"position"===v[0]&&console.log(1);u=n.rule[v[0]],f=v[0],h=v[1],u&&d(u)&&(p=u(a,t,v[1]))}else{if(c.test(i[r])){var b=i[r].split("|");u=n.rule[b[0]],f=b[0],g=b[1],/\{.*\}/g.test(g)||(g="",console.log("定位的格式不正确"))}else u=n.rule[i[r]],f=i[r];u&&d(u)&&(p=u(a,t))}if(p)return{html:p,type:f,typeVal:h,position:n.handlePositionStr(g)}}return null}},handleText:function(e,t,n){var i=e.attr("data-validate-"+t+"Text"),o=a.text[t],r=i?i:o,l=/{{param}}/;return e.attr("data-validate-"+t+"Text",r),r.replace(l,n)},handleMessage:function(e,t,i,o,r){var l=this,s=e.parents(".ui-form"),c=s.find(".ui-form-message"),d=s.find(".l-form-error"),u=s.find("[data-validate]"),p=a.target,f=l.handlePositionStr(u.attr("data-validate-position")),h='<span class="error"><i></i>'+t+"</span>",g=function(e){s.css({position:"relative"}),c.attr("style","").css(e).css({position:"absolute"}).addClass("ui-form-message-absolute").find(".arrow").addClass(function(){return e.top?"arrowTop":e.bottom?"arrowBottom":void 0})};if(!c.length)if(e.next(".ui-form-message").length)c=e.next(".ui-form-message");else if(0===c.length&&(c=p.find(".ui-form-message"),1===c.length&&c.html(h),!n.getStatus()))return;return t?(1!==u.length&&d.length&&i&&(h='<span class="error"><i class="icon"></i><i class="arrow"></i>'+l.handleText(d.eq(0),i,o)+"</span>"),c.html(h),void(r?g(r):f?g(f):a.position&&g(a.position))):(c.empty(),!1)},handleError:function(e,t){var n=this,a=e.attr("data-ishideValidte"),i="true"===a&&a?"l-form-error l-form-hideError":"l-form-error",o=t?t.type:null,r=t?t.html:null,l=t?t.typeVal:null,s=t?t.position:null;return r?(e.addClass(i).attr("data-validate-result","false").parents(".l-select-wrap").find(".l-select-single-init").addClass(i),n.handleMessage(e,r,o,l,s)):(e.removeClass(i).attr("data-validate-result","true").parents(".l-select-wrap").find(".l-select-single-init").removeClass(i),n.handleMessage(e)),r},run:function(){var t=this,i=a.target,o=a.rules,r=a.ajax,l=function(n){function a(){var e=(u.filter(function(){return this.value}),u.filter(function(){return!this.value})),a=u.filter(function(){return"true"===this.getAttribute("data-validate-result")}),i=u.filter(function(){return"false"===this.getAttribute("data-validate-result")});if(p){if(p===u.length)return;if(!s&&n.hasClass("l-form-error")&&e.length!==u.length)return t.handleError(n);if(!s&&i.length)return;if(!s&&a.length)return;return t.handleError(n,f)}if(e.length===u.length)return t.handleError(u,f);if(e.length&&s)return t.handleError(u,f)}function l(e,a,i){return a?t.handleError(n):t.handleError(n,e,i?n.attr("data-validate-"+e+"Text"):"")}var s=n.val(),c=n.attr("data-validate"),d=n.attr("data-validate-name"),u=i.find('[data-validate-name="'+d+'"]'),p=n.parents(".ui-form").find(".l-form-error").length,f=null;return e.base.isFunction(o)&&"process"===c?l(c,o(n),!0):e.base.isFunction(r)&&"ajax"===c?(l(c),r(n,function(e,t){l(c,e,t)}),!0):(f=t.route(n),d?f?"required"!==f.type?s&&t.handleError(n,f):a():t.handleError(u):f?t.handleError(n,f):t.handleError(n))},s=function(e){var n=e.attr("data-ishideValidte"),a="true"===n&&n?"l-form-error l-form-hideError":"l-form-error",o=e.attr("data-validate-name"),r=i.find('[data-validate-name="'+o+'"]'),l=r.parents(".ui-form").find(".l-form-error").length;"checkbox"!==e[0].type&&"radio"!==e[0].type||$("input[name='"+e[0].name+"']").removeClass(a),r.length&&l||(r.length?t.handleError(r):t.handleError(e))},c=function(){for(var e=i.find("[data-validate]"),t=e.length,a=0;a<t;a++)l(e.eq(a))||s(e.eq(a));return n.getStatus()};i.on("blur","[data-validate]",function(e){l($(e.currentTarget))}).on("focus","[data-validate]",function(e){s($(e.currentTarget))}).on("change","select[data-validate]",function(e){l($(e.currentTarget))}).on("submit",function(){return c()}).on("all",function(){return c()})},init:function(e){for(var t in e)e.hasOwnProperty(t)&&void 0!==e[t]&&void 0!==a[t]&&(a[t]=e[t]);a.target=$(a.target),a.target.length||console.log("target not find"),i.run()}};return n.reset=function(){for(var e=a.target,t=e.find("[data-validate]"),n=e.find(".ui-form-message"),i=t.length,o=0;o<i;o++)t.eq(o).removeClass("l-form-error").next(".l-select-single").find(".l-select-single-init").removeClass("l-form-error"),n.eq(o).empty()},n.getStatus=function(){var e=a.target,t=e.find(".l-form-error"),n=t.filter(function(){var e=$(this);return e.filter(":visible").length&&(e.filter(":enabled").length||e.hasClass("l-select-single-init"))}),i=t.filter(".l-form-hideError"),o=n.length+i.length,r=n.length?n.offset().top:0;return n.length&&$(window).height()<r&&$("html, body").animate({scrollTop:r},500),!o},n.validatorAll=function(){return a.target.triggerHandler("all")},n.reload=function(){console.log("target overloaded"),i.init(t)},i.init(t)};return function(e){return e?new t(e):{}}}),define("core/drag",[],function(){"use strict";var e=function(e){function t(e){var t="auto"===i.css("top")?0:i.css("top"),n="auto"===i.css("left")?0:i.css("left");i.css({top:parseInt(t)+(e.clientY-r.y),left:parseInt(n)+(e.clientX-r.x)}),r.x=e.clientX,r.y=e.clientY}var n=e||{};if(!n.dragItem)return!1;var a=$("body").find(n.dragItem),i=$("body").find(n.dragWrap),o=parent.document||document,r={x:0,y:0};a.on("mousedown",function(e){r.x=e.clientX,r.y=e.clientY,$(o).on("mousemove",t),e.preventDefault?e.preventDefault():e.returnValue=!1}),$(o).on("mouseup",function(){$(o).off("mousemove",t)})};return e}),function(){"use strict";function e(e,t,n,a,i,o){t[e]&&(n.push(e),t[e]!==!0&&1!==t[e]||a.push(i+e+"/"+o))}function t(e,t,n,a,i){var o=a+t+"/"+i;require._fileExists(e.toUrl(o+".js"))&&n.push(o)}function n(e,t,a){var i;for(i in t)!t.hasOwnProperty(i)||e.hasOwnProperty(i)&&!a?"object"==typeof t[i]&&(!e[i]&&t[i]&&(e[i]={}),n(e[i],t[i],a)):e[i]=t[i]}var a=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(i){var o=i.config?i.config():{};return{version:"2.0.4",load:function(i,r,l,s){s=s||{},s.locale&&(o.locale=s.locale);var c,d,u,p=a.exec(i),f=p[1],h=p[4],g=p[5],v=h.split("-"),m=[],b={},w="";if(p[5]?(f=p[1],c=f+g):(c=i,g=p[4],h=o.locale,h||(h=o.locale="undefined"==typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),v=h.split("-")),s.isBuild){for(m.push(c),t(r,"root",m,f,g),d=0;d<v.length;d++)u=v[d],w+=(w?"-":"")+u,t(r,w,m,f,g);r(m,function(){l()})}else r([c],function(t){var a,i=[];for(e("root",t,i,m,f,g),d=0;d<v.length;d++)a=v[d],w+=(w?"-":"")+a,e(w,t,i,m,f,g);r(m,function(){var e,a,o;for(e=i.length-1;e>-1&&i[e];e--)o=i[e],a=t[o],a!==!0&&1!==a||(a=r(f+o+"/"+g)),n(b,a);l(b)})})}}})}(),define("core/nls/str",{root:{close:"关闭",alert:"提示？",confirm:"确认？",error:"错误",nextPage:"&gt;",prevPage:"&lt;",countFont:"",nullText:"暂无数据，请确认！",requestText:"数据请求中，请稍后..."},en:!0}),define("core/dialog",["core/cncnERP","core/drag","i18n!core/nls/str"],function(e,t,n){var a={init:function(n){var a=n||{},i=a.title||"",o=a.text||"",r=a.btns||"",l=a.type||"",s=a.top,c=a.left,d=a.ok||"",u=a.no||"",p=a.okText?a.okText:"确认",f=a.noText?a.noText:"取消",h=a.width||200,g=a.height||50,v=a.id||"l-dialog-"+(new Date).valueOf(),m="l-dialog-title"+(new Date).valueOf(),b=void 0===a.isMask||a.isMask,w=(void 0===a.isMaskClose||a.isMaskClose,void 0===a.allowClose||a.allowClose),x=void 0===a.allowEscClose||a.allowEscClose,y=void 0===a.isDrag||a.isDrag,k="";k+='<div class="l-ui l-dialog-wrap l-ui-current l-ui-mask" id="'+v+'">',k+='\t<table class="l-dialog-table">',k+='\t\t<tr><td colspan="3" class="l-dialog-border l-dialog-border-top">&nbsp;</td></tr>',k+="\t\t<tr>",k+='\t\t\t<td class="l-dialog-border l-dialog-border-left">&nbsp;</td>',k+='\t\t\t<td class="l-dialog-main"><div class="l-dialog-content" style="width:'+h+"px;height:"+g+'px"><div class="l-dialog-text">'+o+"</div></div></td>",k+='\t\t\t<td class="l-dialog-border l-dialog-border-right">&nbsp;</td>',k+="\t\t</tr>",k+='\t\t<tr><td colspan="3" class="l-dialog-border l-dialog-border-bottom">&nbsp;</td></tr>',k+="\t</table>",k+="</div>",e.ui.wrap(),$("#l-ui-wrap").prepend(k);var C=$("#"+v),S=C.find(".l-dialog-main"),j=C.find(".l-dialog-content");e.ui.dialog.setZIndex(v),C.attr("tabindex","1"),C.focus(),i&&S.prepend('<div class="l-dialog-title" id="'+m+'">'+i+"</div>"),l&&S.find(".l-dialog-content").addClass("l-dialog-"+l);var T=S.append('<div class="ui-floatCenter l-dialog-btnWrap"><div class="ui-sl-floatCenter"></div></div>').find(".ui-floatCenter"),D=S.find(".ui-sl-floatCenter");T.height();if(r)$.each(r,function(t,n){D.append('<a href="javascript:;" class="'+(n.cls?"ui-btn ui-btnMain ui-floatCenter-item "+n.cls:"ui-btn ui-btnMain ui-floatCenter-item")+'"><span>'+n.text+"</span></a>"),n.onclick&&D.find("a").eq(t).click(function(){n.onclick(t,n),e.ui.dialog.close(v)})});else switch(l){case"alert":j.prepend('<div class="l-dialog-icon"><i class="icon icon-check-square-o"></i></div>'),D.append('<a href="javascript:;" class="ui-btn ui-btn-primary ui-floatCenter-item l-dialog-ok"><span>'+p+"</span></a>"),D.find(".l-dialog-ok").click(function(){e.base.isFunction(d)&&d(),e.ui.dialog.close(v)});break;case"confirm":j.prepend('<div class="l-dialog-icon"><i class="icon icon-question-circle"></i></div>'),D.append('<a href="javascript:;" class="ui-btn ui-btn-primary ui-floatCenter-item l-dialog-ok"><span>'+p+'</span></a><a href="javascript:;" class="ui-btn ui-btnMain ui-btnMain-cancel ui-floatCenter-item l-dialog-no"><span>'+f+"</span></a>"),D.find(".l-dialog-ok").click(function(){e.base.isFunction(d)&&d(),e.ui.dialog.close(v)}),D.find(".l-dialog-no").click(function(){e.base.isFunction(u)&&u(),e.ui.dialog.close(v)});break;case"error":j.prepend('<div class="l-dialog-icon"><i class="icon icon-frown-o"></i></div>'),D.append('<a href="javascript:;" class="ui-btn ui-btn-primary ui-btnMain-cancel ui-floatCenter-item l-dialog-no"><span>'+f+"</span></a>"),D.find(".l-dialog-no").click(function(){e.base.isFunction(u)&&u(),e.ui.dialog.close(v)})}var I=$(window),F=C.find(".l-dialog-icon"),A=C.find(".l-dialog-text"),M=function(){C.css({top:s||(I.height()-C.height())/2,left:c||(I.width()-C.width())/2})};if(M(),I.resize(M),F.css({top:(g-F.height())/2+15}),A.css({"padding-top":(g-A.height())/2}),j.css({opacity:.1}).animate({opacity:1},500),b&&e.ui.lock(),y&&t({dragItem:"#"+m,dragWrap:"#"+v}),w&&(S.prepend('<div class="l-dialog-close"><i class="icon icon-close" title="关闭"></i></div>').find(".l-dialog-close").click(function(){e.ui.dialog.close(v)}),x)){var E=function(t){t=t||event;var n=t.which||event.keyCode;27===n&&e.ui.dialog.close(v)};document.attachEvent?document.attachEvent("onkeydown",E):document.addEventListener("keydown",E,!0)}},setZIndex:function(t){var n=$(".l-ui"),a=0,i=n.length,o=e.ui.zIndex(),r=$(".l-ui-lock"),l=Number(r.css("z-index")),s=$("#"+t);if(s.hasClass("l-ui-current")){for(;a<i;a++)n.eq(a).css({"z-index":l-a});n.removeClass("l-ui-current"),s.css({"z-index":o})}else for(;a<i;a++)n.eq(a).css({"z-index":l+i-a})},close:function(t){t?$("#"+t).remove():$(".l-dialog-wrap").remove(),$(".l-ui-mask").length||e.ui.unlock(),e.ui.dialog.setZIndex(t)},alert:function(e){var t=e||{},a=t.title||n.alert,i=t.text||"",o=t.width,r=t.height,l=t.ok||"",s=t.okText;return this.init({title:a,text:i,width:o,height:r,type:"alert",ok:l,okText:s}),this},confirm:function(e){var t=e||{},a=t.title||n.confirm,i=t.text||"",o=t.width,r=t.height,l=t.ok||"",s=t.no||"",c=t.okText,d=t.noText;return this.init({title:a,text:i,width:o,height:r,type:"confirm",ok:l,no:s,okText:c,noText:d}),this},error:function(e){var t=e||{},a=t.title||"",i=t.text||n.error,o=t.width,r=t.height,l=t.no||"",s=t.noText;return this.init({title:a,text:i,width:o,height:r,type:"error",no:l,noText:s}),this},prompt:function(t){function n(){e.ui.dialog.close(i),d&&"function"==typeof d&&d()}var a=t||{},i=a.id||"l-dialog-"+(new Date).valueOf(),o=a.top,r=a.left,l=(a.cls||"",a.text||""),s=a.isMask||!0,c=a.showTime||2e3,d=a.endFn||"",u=a.width||"",p=a.height||"auto";e.ui.wrap();var f="";f+='<div class="l-ui l-dialog-wrap" id="'+i+'">',f+='\t<div class="l-dialog-prompt">'+l+"</div>",f+="</div>",$("#l-ui-wrap").prepend(f);var h=e.ui.zIndex(),g=$("#"+i).css({width:u,height:p,"z-index":h}),v=$(window),m=function(){g.css({top:o||(v.height()-g.height())/2,left:r||(v.width()-g.width())/2})};m(),v.resize(m),s&&e.ui.lock(),setTimeout(n,c)}};return a}),define("core/pop",["core/cncnERP"],function(e){"use strict";var t=function(t){var n=this,a={id:"l-pop-"+(new Date).valueOf(),titleId:"l-pop-title-"+(new Date).valueOf(),title:"",width:500,height:300,top:null,left:null,cls:"",url:"",ajax:"",ajaxType:"POST",ajaxData:"",ajaxSuccess:null,async:!1,html:"",onloadFn:null,closeFn:null,btns:"",isMask:!0,isMaskClose:!1,allowClose:!0,allowEscClose:!0,isDrag:!0},i={popTitle:$(),popContent:$(),btnWrap:$(),mask:$()},o={createMask:function(){var t=a.isMask,o=a.isMaskClose;if(t){var r=e.ui.lock();o&&allowClose&&lock.click(function(){n.close()}),i.mask=r,a.popWrap.addClass("l-ui-mask")}},createTitle:function(){var t=a.id,o=a.title,r=a.titleId,l=a.popMain,s=a.isDrag,c=a.allowClose;if(o){var d=l.append('<div class="l-pop-title" id="'+r+'"></div>').find(".l-pop-title").html(o);s&&e.ui.drag({dragItem:"#"+r,dragWrap:"#"+t}),c&&(l.find(".l-pop-close").length||l.prepend('<div class="l-pop-close"><i title="关闭"></i></div>'),l.find(".l-pop-close").click(function(){n.close()})),i.popTitle=d}},createContent:function(){var t=a.popMain.append('<div class="l-pop-content"></div>'),n=a.url,o=a.ajax,r=a.ajaxType,l=a.ajaxData,s=a.async,c=a.ajaxSuccess,d=a.html,u=t.find(".l-pop-content");n?u.append('<iframe src="'+n+'" frameborder="no" border="0"></iframe>').addClass("l-pop-contentIframe"):o?$.ajax({url:o,type:r,data:l,cache:!1,async:s,success:function(t){e.base.isFunction(c)&&c(t),u.append(t)}}):d&&u.append(d),i.popContent=u},createBtn:function(){var t=a.id,o=a.btns,r=a.popMain;if(o){r.find(".l-pop-btnWrap").length||r.append('<div class="ui-floatCenter l-pop-btnWrap"><div class="ui-sl-floatCenter"></div></div>');for(var l=0,s=o.length,c="",d=r.find(".ui-floatCenter"),u=r.find(".ui-sl-floatCenter").html("");l<s;l++){var p=o[l],f="ui-btn ui-floatCenter-item ui-btn-primary "+(p.cls?p.cls:"");c+='<a href="javascript:;" data-index="'+l+'" class="'+f+'"><span>'+p.text+"</span></a>"}u.append(c).on("click","a",function(){var a=$(this),i=Number(this.getAttribute("data-index")),r=o[i],l=void 0===r.closePop||r.closePop===!1;e.base.isFunction(r.onclick)&&r.onclick.apply(this,[t,i,r,a]),l&&n.close(t)}),i.btnWrap=d}},escCloseFn:function(){var e=a.allowClose,t=a.allowEscClose;a.popMain;if(e&&t){var i=function(e){e=e||event;var t=e.which||event.keyCode;27===t&&n.close()};document.attachEvent?document.attachEvent("onkeydown",i):document.addEventListener("keydown",i,!0)}},setShowFn:function(){var e=$(window),t=a.popWrap,n=i.popContent,o=(i.popTitle.outerHeight(),i.btnWrap.outerHeight(),function(){var i=e.height(),o=e.width(),r=a.height,l=a.width;n.css({height:r,width:l}),t.css({top:a.top||(i-t.height())/2,left:a.left||(o-t.width())/2})});o(),e.resize(o),n.css({opacity:.1}).animate({opacity:1},800)},setZIndex:function(){if(a.isMask){var t=$(".l-ui"),n=0,o=t.length,r=e.ui.zIndex(),l=i.mask,s=Number(l.css("z-index")),c=a.popWrap;if(c.hasClass("l-ui-current")){for(;n<o;n++)t.eq(n).css({"z-index":s-n});t.removeClass("l-ui-current"),c.css({"z-index":r})}else for(;n<o;n++)t.eq(n).css({"z-index":s+o-n})}},loadFn:function(){e.base.isFunction(a.onloadFn)&&a.onloadFn(a.id,a.popMain)},run:function(){this.createMask(),this.createTitle(),this.createContent(),this.createBtn(),this.escCloseFn(),this.setShowFn(),this.setZIndex(),this.loadFn()},init:function(t){for(var i in t)t.hasOwnProperty(i)&&void 0!==t[i]&&(a[i]=t[i]);var o="";o+='<div class="l-ui l-pop-wrap l-ui-current" id="'+a.id+'">',o+='\t<table class="l-pop-table">',o+='\t\t<tr><td colspan="3" class="l-pop-border l-pop-border-top"></th></tr>',o+="\t\t<tr>",o+='\t\t\t<td class="l-pop-border l-pop-border-left"></td>',o+='\t\t\t<td class="l-pop-main"></td>',o+='\t\t\t<td class="l-pop-border l-pop-border-right"></td>',o+="\t\t</tr>",o+='\t\t<tr><td colspan="3" class="l-pop-border l-pop-border-bottom"></td></tr>',o+="\t</table>",o+="</div>";var r=e.ui.wrap();return r.prepend(o),a.popWrap=$("#"+a.id),a.popMain=a.popWrap.find(".l-pop-main"),a.popWrap.attr("tabindex","1"),a.popWrap.focus(),this.run(),n}};return n.close=function(t){var n=a.closeFn;a.popWrap.remove(),o.setZIndex(),a.popWrap.find(".l-select-wrap").addClass("fn-hide"),$(".l-ui-mask").length||e.ui.unlock(),e.base.isFunction(n)&&(t=void 0!==t?t:a.id,a.closeFn(t))},n.modifyTitle=function(e){return i.popTitle.html(e),n},n.modifyBtns=function(e){return a.btns=e,o.createBtn(),n},n.modifyWrap=function(e,t){return a.width=e,a.height=t,o.setShowFn(),n},o.init(t)};return function(e){return new t(e)}}),define("core/tab",["core/cncnERP"],function(e){"use strict";var t=function(t){var n=t||{};if(!n.tabItem)return!1;var a=n.tabItem,i=n.tabWrap||null,o=n.tabEvent||"click",r=n.tabIndex||0,l=n.isAuto||!1,s=n.autoTime||2e3,c=n.autoSpeed||0,d=n.onclick?n.onclick:null,u={init:function(){if(i){var e=$(i),t=r,n=e.eq(t),s=$(a);n.show().siblings(i).hide(),s.on(o,function(){t=s.index(this),u.cutoverFn(t,this)}),l&&u.autoFn(t)}},cutoverFn:function(t,n){var o=$(i),r=o.eq(t);r.html()?(c?r.stop(!0,!0).fadeIn(c).siblings(i).fadeOut(c):r.stop(!0,!0).show().siblings(i).hide(),r.addClass("on").siblings(a).removeClass("on")):o.hide(),e.base.isFunction(d)&&d.apply(n,[t,o])},autoFn:function(e){var t=$(i).size(),n=function(){u.cutoverFn(e),e++,e===t&&(e=0)},o=setInterval(n,s);$(a).parent().hover(function(){clearInterval(o)},function(){o=setInterval(n,s)})}};u.init()};return t}),define("jquery",[],function(){return jQuery}),function(e,t){"function"==typeof define&&define.amd?define("core/upload",["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):e.Upload=t(e.jQuery)}(this,function(e){"use strict";var t=function(t){var n=this,a={file:'<input type="file" name="{{name}}" />',params:'<input type="hidden" name="{{name}}" value="{{value}}" />',iframe:'<iframe name="iframe_{{name}}"></iframe>',form:'<form method="post" enctype="multipart/form-data" name="form_{{name}}" target="iframe_{{name}}" action="{{url}}"></form>'},i={_tpl:function(e,t){return e.replace(/{{(.*?)}}/g,function(e,n){return void 0===t[n]?"":t[n]})},_each:function(e,t){for(var n="",a=0,o=t?t.length:0;a<o;a++)t[a].index=a,n+=i._tpl(e,t[a]);return n},init:function(){var t=n.target,o=n.url,r=n.name,l={},s="";return o?t?(l={url:o+"?v="+Math.random(),name:r},t.prev(".l-upload-wrap").length||t.before('<div class="l-upload-wrap" style="display:none;">'+i._tpl(a.form,l)+"</div>"),
s=i._each(a.params,n.params)+i._tpl(a.file,l),void t.off("click").on("click",function(){var t=e(this),o=t.prev(".l-upload-wrap"),r=o.find("form").html(s),c=o.find('input[type="file"]'),d=null;return!(n.onStart&&!n.onStart(t))&&(c.click().change(function(){n.onSend&&n.onSend(t),r.submit()}),void(d=o.append(i._tpl(a.iframe,l)).find("iframe").load(function(){var a=e(this).contents().find("body").html().match(/\{.*\}/g)[0];"json"===n.dataType&&"string"==typeof a&&(a=e.parseJSON(a)),"[object Function]"===Object.prototype.toString.call(n.onComplate)&&a&&n.onComplate.apply(t,[a,t]),d.remove()})))})):console.log("target is not define"):console.log("url is not define")}};n.target=e(t.trigger),n.url=t.url||"",n.name=t.name||"filedata",n.params=t.params||{},n.dataType=t.dataType||"json",n.onSend=t.onSend||"",n.onStart=t.onStart||"",n.onComplate=t.onComplate||"",n.run=i.init};return t.prototype={constructor:t,setParams:function(e){this.params=e},load:function(t){this.target=e(t.trigger),this.url=t.url||"",this.run()}},function(e){return e?new t(e):{}}}),define("core/select",["core/cncnERP"],function(e){"use strict";var t=function(t){var n=this,a={id:"l-select-"+(new Date).valueOf(),data:null,selectedData:null,ajax:null,target:null,wrap:null,width:200,height:"auto",type:"single",checkbox:!1,radio:!1,isArrow:!0,onClick:null,onRightClick:null,onMouseOver:null,onMouseOut:null,onLoad:null,onDel:null,isAllowEnter:!0,check:null},i={data:[],selectedData:[]},o={move:function(e,t,n){var a=e[0],i=a.scrollHeight,o=a.clientHeight,r=(a.offsetTop,t[0].offsetTop),l=t.outerHeight(),s=t.offset().top-e.offset().top;console.log(r,s,o,Math.ceil(i/o)),t.offset().top-e.offset().top>o,t.offset().top-e.offset().top>r-o,r+l>o&&e.scrollTop(e.scrollTop()+l),s<l&&(console.log(e.scrollTop(),l),e.scrollTop(e.scrollTop()-l))},show:function(e){var t=$(".l-select-down"),n=e.find(".l-select-down"),a=$(".l-select-wrap");t.addClass("fn-hide"),n.removeClass("fn-hide"),a.css({"z-index":""}),e.css({"z-index":"10"})},close:function(){var e=$(".l-select-down"),t=$(".l-select-wrap");e.addClass("fn-hide"),t.css({"z-index":""})},createSingleHtml:function(){for(var e=a.target,t=a.isArrow,n=a.target.length,i=0;i<n;i++){var o=e.eq(i);if(!o.parent().hasClass("l-select-wrap")){var r=o.outerWidth(),l=o[0].className,s=o.wrap('<div class="l-select-wrap"></div>').after('<div class="l-select-single"><div class="l-select-single-init '+l+'"></div><div class="l-select-down fn-hide"><ul class="l-select-single-ul"></ul></div></div>').val(),c=o.find("option:selected"),d=o.find("option"),u=d.length,p=0,f=o.next(".l-select-single"),h=f.find(".l-select-single-init"),g=c.html(),v=f.find(".l-select-single-ul"),m="";for(t&&(f.append('<div class="l-select-single-arrow"></div>'),h.addClass("l-select-single-init-arrow"));p<u;p++){var b=d.eq(p),w=b.val(),x=b.html();m+=w===s&&""!==w?'<li class="l-select-single-li on" data-index="'+p+'">'+x+"</li>":'<li class="l-select-single-li" data-index="'+p+'">'+x+"</li>"}h.html(g).width(r),v.html(m).width(h.outerWidth()-2),a.wrap=a.target.parent()}}},refreshSingleHtml:function(){for(var e=a.target,t=a.target.length,n=0;n<t;n++){for(var i=e.eq(n),o=i.outerWidth(),r=i.val(),l=i.find("option:selected"),s=i.find("option"),c=s.length,d=0,u=i.next(".l-select-single"),p=u.find(".l-select-single-init"),f=l.html(),h=u.find(".l-select-single-ul"),g="";d<c;d++){var v=s.eq(d),m=v.val(),b=v.html();g+=m===r&&""!==m?'<li class="l-select-single-li on" data-index="'+d+'">'+b+"</li>":'<li class="l-select-single-li" data-index="'+d+'">'+b+"</li>"}p.html(f).width(o),h.html(g),a.wrap=a.target.parent()}},singleFn:function(){var t=this,n=a.wrap,i=null,o=$("body"),r=!1;e.ui.onselectstart(n),n.on("click",".l-select-single-li",function(e){var n=$(e.currentTarget),a=n.attr("data-index"),i=n.html(),o=n.parents(".l-select-wrap").find("select"),l=o.find("option"),s=l.eq(a),c=n.parent().prev();r=!1,c.html(i),l.attr("selected",!1),s.attr("selected",!0),t.close(),o.trigger("change")}).on("mouseover",".l-select-single-li",function(e){var t=$(e.currentTarget),n=t.siblings();t.addClass("on"),n.removeClass("on")}).on("click",".l-select-single-init",function(e){var n=$(e.currentTarget),a=n.parents(".l-select-wrap"),o=n.outerWidth(),l=a.find(".l-select-single-ul");return l.width(o-2),r=!0,i=n,t.show(a),e.stopPropagation(),!1}).on("change","select",function(){t.refreshSingleHtml()}).on("click",".l-select-single-arrow",function(e){var t=$(e.currentTarget),n=t.siblings(".l-select-single-init");n.trigger("click"),e.stopPropagation()}),o.on("click",function(){r&&(t.close(),r=!1)}).on("keydown",function(e){if(r&&i){var n=i.next().find(".l-select-single-ul"),a=n.find(".l-select-single-li"),o=a.length,l=n.find(".on").attr("data-index");switch(e.stopPropagation(),e.keyCode){case 13:i.html(a.eq(l).html()),t.close(),r=!1;break;case 38:l>0&&(l--,a.eq(l).addClass("on").siblings().removeClass("on"),t.move(n,n.find(".on"),l)),e.preventDefault();break;case 40:l<o-1&&(l++,a.eq(l).addClass("on").siblings().removeClass("on"),t.move(n,n.find(".on"),l)),e.preventDefault()}}})},createMultipleHtml:function(){var e,t=a.target,n=t.parent(),i=a.width;n.hasClass("l-select-wrap")||(n=t.wrap('<div class="l-select-wrap"></div>').parent()),e='<div class="l-select-multiple-selected fn-clear" style="width:'+i+'px"><ul><li class="l-select-multiple-selected-input"><input type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="l-select-multiple-input" /></li></ul></div><div class="l-select-down fn-hide"><ul class="l-select-multiple-down" style="width:'+(i-2)+'px"></ul></div>',n.find(".l-select-multiple").length?n.find(".l-select-multiple").html(e):n.append('<div class="l-select-multiple">'+e+"</duv>"),a.wrap=n},refreshMultipleHtml:function(){var e=a.wrap,t=e.find(".l-select-multiple-down"),n=a.checkbox,o=a.radio,r=a.wrap.find(".l-select-multiple-input"),l=r.val(),s=""===l||void 0===l,c=(n||o)&&s?a.data:i.data,d=c?c.length:0,u=0,p="",f=a.width-48;if(n)for(p+='<li class="fn-clear"><span class="l-checkbox l-checkbox-all fn-left"></span><span class="fn-left">全选</span></li>';u<d;u++)p+='<li class="l-select-multiple-down-li'+(0===u?" on":"")+' fn-clear" data-id="'+c[u].id+'" data-val="'+c[u].val+'" data-index="'+u+'"><span class="l-checkbox fn-left l-checkbox-'+u+'"></span><span class="fn-left" style="width:'+f+'px">'+c[u].name+"</span></li>";else if(o)for(;u<d;u++)p+='<li class="l-select-multiple-down-li'+(0===u?" on":"")+' fn-clear" data-id="'+c[u].id+'" data-val="'+c[u].val+'" data-index="'+u+'"><span class="l-radio fn-left l-radio-'+u+'"></span><span class="fn-left" style="width:'+f+'px">'+c[u].name+"</span></li>";else for(;u<d;u++)p+='<li class="l-select-multiple-down-li l-select-multiple-down-li-'+u+(0===u?" on":"")+'" data-id="'+c[u].id+'" data-val="'+c[u].val+'">'+c[u].name+"</li>";t.html(d?p:"")},modifyMultipleSelectedData:function(){var e=a.data,t=e?e.length:0,n=0,o=a.wrap.find(".l-select-multiple-input"),r=i.selectedData,l=r.length,s=o.val(),c=a.checkbox,d=a.radio,u=new RegExp((s?s:"").toLowerCase()),p=null,f=!1;if(!c&&!d||""!==s)for(i.data=[];n<t;n++){p=e[n].name?e[n].name+"":"",f=!1;for(var h=0;h<l;h++)r[h]&&r[h].name===e[n].name&&(f=!0);u.test(p.toLowerCase())&&(f?(c||d)&&i.data.push(e[n]):i.data.push(e[n]))}},multipleFn:function(){var n=this,o=a.target,r=a.wrap,l=a.checkbox,s=a.radio,c=r.find(".l-select-multiple-selected"),d=r.find(".l-select-multiple-input"),u=r.find(".l-select-multiple-down"),p=a.data,f=p?p.length:0,h=$("body"),g=!1,v={setInputSize:function(){var e=c.find(".l-select-multiple-selected-li:last"),t=e.outerWidth(),n=e.offset(),i=n?n.left:0,o=c.offset(),r=o?o.left:0,l=a.width,s=c.is(":hidden");(d.width()<=l||l<10)&&(l-=i+t-r+5),e.length||(l=a.width),d.focus().width(l),u.css({top:function(){if(s){var e=c.parents(":hidden").filter(function(){return"none"===this.style.display}).show(),t=c.outerHeight();return e.hide(),t}return c.outerHeight()}})},setSelectedInput:function(){for(var e=c.find(".l-select-multiple-selected-li"),t=e.length,n=0,a=[],i=[],r=[];n<t;n++)a.push(e.eq(n).attr("data-id")),i.push(e.eq(n).attr("data-name")),r.push(e.eq(n).attr("data-val"));o.val(a.join()).attr({"data-name":i.join(),"data-val":r.join()})},addSelectItem:function(e,t){var n=e.attr("data-id"),o=0,r=d.val(),l=a.checkbox,c=!0;if(t)i.selectedData=[],i.selectedData=i.selectedData.concat(p);else for(;o<f;o++)Number(p[o].id)===Number(n)&&(s&&(i.selectedData=[]),i.selectedData.push(p[o]));(l||s)&&(c=!1),v.initSelected(r,c)},removeSelectItem:function(e,t){var n=e.attr("data-id"),o=i.selectedData,r=o.length,s=0,c=d.val(),u=!0;if(l&&t)i.selectedData=[];else for(;s<=r;s++)o[s]&&Number(o[s].id)===Number(n)&&i.selectedData.splice(s,1);l&&(u=!1),console.log(i.selectedData,a.data,i.data),v.initSelected(c,u)},initSelected:function(e,t){var o=a.data,r=o.length,l=i.selectedData,p=l.length,f=0,h="",g="",m="",b=a.checkbox,w=a.width-34,x='style="max-width:'+w+'px"';for(t=void 0===t||t,t&&n.modifyMultipleSelectedData(),n.refreshMultipleHtml();f<p;f++){if(b||s){for(var y=0;y<r;y++){var k=u.find(".l-select-multiple-down-li"),C=k.eq(y),S=k.length;Number(C.attr("data-id"))===Number(l[f].id)&&(C.find(".l-checkbox").addClass("l-checkbox-selected").end().find(".l-radio").addClass("l-radio-selected"),h=" l-select-multiple-selected-li-"+y,g=' data-index="'+y+'"')}(p===r||k&&k.find(".l-checkbox-selected").length===S)&&u.find(".l-checkbox-all").addClass("l-checkbox-selected")}m+='<li class="l-select-multiple-selected-li'+h+'" data-id="'+l[f].id+'" data-val="'+l[f].val+'" data-name="'+l[f].name+'"'+x+g+">"+l[f].name+'<span class="l-select-multiple-selected-del">x</span></li>'}c.find(".l-select-multiple-selected-li").remove().end().find(".l-select-multiple-selected-input").before(m),d.val(e),v.setInputSize(),v.setSelectedInput()}};a.data&&(a.selectedData&&(i.selectedData=a.selectedData),v.initSelected(),e.ui.onselectstart(r)),r.on("click",".l-select-multiple-selected",function(e){e.stopPropagation(),d.focus(),g=!0,n.show(r)}).off("click",".l-select-multiple-down li").on("click",".l-select-multiple-down li",function(n){n.stopPropagation(),g=!0;var a=$(n.currentTarget);l?a.find(".l-checkbox").trigger("click"):s?a.find(".l-radio").trigger("click"):v.addSelectItem(a),e.base.isFunction(t.onClick)&&t.onClick.apply(a,[a])}).on("mouseover",".l-select-multiple-down li",function(e){var t=$(e.currentTarget),n=t.siblings();t.addClass("on"),n.removeClass("on")}).off("click",".l-radio").on("click",".l-radio",function(e){e.stopPropagation();var t=$(e.currentTarget),n=u.find(".l-radio");n.removeClass("l-radio-selected"),t.addClass("l-radio-selected"),v.addSelectItem(t.parent())}).off("click",".l-checkbox").on("click",".l-checkbox",function(e){e.stopPropagation();var t=$(e.currentTarget),n=(t.parent().attr("data-index"),u.find(".l-select-multiple-down-li")),a=(n.length,u.find(".l-checkbox"));t.hasClass("l-checkbox-selected")?t.hasClass("l-checkbox-all")?(a.removeClass("l-checkbox-selected"),v.removeSelectItem(n,!0)):(a.eq(0).removeClass("l-checkbox-selected"),t.removeClass("l-checkbox-selected"),v.removeSelectItem(t.parent())):t.hasClass("l-checkbox-all")?(i.selectedData=[],v.addSelectItem(n,!0)):(t.addClass("l-checkbox-selected"),v.addSelectItem(t.parent()))}).on("click",".l-select-multiple-selected-li",function(e){$(e.currentTarget).find(".l-select-multiple-selected-del").trigger("click")}).on("click",".l-select-multiple-selected-del",function(n){var a=$(n.currentTarget).parent(),i=a.attr("data-index"),o=u.find(".l-checkbox-"+i),r=u.find(".l-checkbox-all");o.removeClass("l-checkbox-selected"),r.removeClass("l-checkbox-selected"),v.removeSelectItem(a),e.base.isFunction(t.onDel)&&t.onDel.apply(a,[a])}).on("click",".l-select-multiple-input",function(e){e.stopPropagation(),g=!0,n.show(r)}).off("keyup",".l-select-multiple-input").on("keyup",".l-select-multiple-input",function(e){var t=$(e.currentTarget),a=e.keyCode,o=t.val(),l=i.selectedData,s=(l.length,/\\|\[|\]|\*|\(|\)|\+|\?/),d=c.find(".l-select-multiple-selected-li:last");if(38!==a||40!==a||13!==a){if(i.data=[],g=!0,n.show(r),s.test(o)&&(o=o.replace(s,"")),8===a&&""===o&&d.length)return!1;v.initSelected(o)}}).off("keydown",".l-select-multiple-input").on("keydown",".l-select-multiple-input",function(e){if(!a.isAllowEnter)return!1;var t=$(e.currentTarget),i=e.keyCode,o=t.val(),l=c.find(".l-select-multiple-selected-li:last");if(8===i){if(""===o)return l.hasClass("on")?v.removeSelectItem(l):l.addClass("on"),!1;o&&o.length&&(t.val(""),v.initSelected(o))}else if(38===i||40===i)t.blur(),g=!0,n.show(r);else if(13===i&&""===o)return!1}),h.on("click",function(){g&&(g=!1,n.close())})},createTreeHtml:function(){var e=a.target,t=e.parent(),n=e.attr("name"),i=a.width,o="";t.hasClass("l-select-wrap")||(t=e.wrap('<div class="l-select-wrap"></div>').parent()),o+='<div class="l-select-tree-selected fn-clear">',o+='\t\t<input type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="l-select-tree-input" name="'+n+'-name"  />',o+="</div>",o+='<div class="l-select-down fn-hide"><div class="l-select-tree-down" style="width:'+i+'px"></div></div>',t.find(".l-select-tree").length?t.find(".l-select-tree").html(o):t.append('<div class="l-select-tree" style="width:'+i+'px">'+o+"</duv>"),a.wrap=t},treeFn:function(){var t=this,n=a.wrap,i=a.target,o=$("body"),r=!1,l=n.find(".l-select-tree-input"),s=null,c=e.base.isArray,d=e.ui.tree({target:n.find(".l-select-tree-down"),data:a.data,selected:a.selectedData,check:a.check,onClick:function(n,o){if(e.base.isFunction(a.onClick)){var s=a.onClick(n,o);if(void 0!==s&&!s)return!1}if(c(o)){for(var d=o.length,u=0,p=[],f=[];u<d;u++)p[u]=o[u].id,f[u]=o[u].name;l.val(f.join()),i.val(p.join())}else l.val(o.name),i.val(o.id);r=!1,t.close()},onLoad:a.onLoad});s=d.getSelected();for(var u=[],p=[],f=0;f<s.length;f++)u[f]=s[f].name,p[f]=s[f].id;l.val(u.join(",")),i.val(p.join(",")),n.off("click",l).on("click",l,function(e){e.stopPropagation(),r=!0,t.show(n)}).on("keyup",l,function(e){i.val(""),d.refresh({selected:[]})}),o.on("click",function(){r&&(r=!1,t.close())})},ajaxGetData:function(t){var n=a.ajax;$.ajax({type:void 0===n.type?"POST":n.type,url:n.url,cache:!1,dataType:"json",data:n.data,beforeSend:function(t){e.base.isFunction(n.beforeSend)&&n.beforeSend()},success:function(a){e.base.isFunction(n.success)&&n.success(a),e.base.isFunction(t)&&t(a)},error:function(t){e.base.isFunction(n.error)&&n.error(t)}})},run:function(){var t=this,n=a.type;switch(n){case"single":if(t.createSingleHtml(),!a.wrap)break;t.singleFn();break;case"multiple":if(t.createMultipleHtml(),!a.wrap)break;t.multipleFn();break;case"tree":if(e.base.isFunction(e.ui.tree)){if(t.createTreeHtml(),!a.wrap)break;t.treeFn()}}},init:function(t){for(var i in t)t.hasOwnProperty(i)&&void 0!==t[i]&&(a[i]=t[i]);return a.target=$(a.target),a.data||a.ajax||(a.data=[]),a.ajax?(o.ajaxGetData(function(t){a.data=t,o.run(),e.base.isFunction(a.onLoad)&&a.onLoad()}),n):(o.run(),a.data&&e.base.isFunction(a.onLoad)&&a.onLoad(),n)}};return n.refresh=function(e){for(var t in e)e.hasOwnProperty(t)&&void 0!==e[t]&&!e.target&&(a[t]=e[t]);return o.init(),n},n.reload=function(){i.selectedData=[],o.init(t)},o.init(t)};return function(e){return e?new t(e):{}}}),define("core/grid",["core/cncnERP","i18n!core/nls/str","core/select"],function(e,t,n){"use strict";var a=function(n){var a=this,i={wrap:$(n.wrap),id:n.id||"l-grid-"+(new Date).valueOf(),pageAjax:n.pageAjax||null,data:n.data||{},width:n.width||"auto",isFixedWidth:void 0!==n.isFixedWidth&&n.isFixedWidth,columns:n.columns||{},statis:n.statis||[],statisToFixed:void 0===n.statisToFixed?2:n.statisToFixed,detail:n.detail||null,bottomBtns:void 0===n.bottomBtns?null:n.bottomBtns,isPage:void 0===n.isPage||n.isPage,isHead:void 0===n.isHead||n.isHead,showAllRow:!!n.showAllRow,pageIndex:n.pageIndex||1,pageSize:n.pageSize||10,pageSizeOptions:void 0===n.pageSizeOptions?[10,20,50,100,200]:n.pageSizeOptions,onPageFn:n.onPageFn,isPageCache:void 0===n.isPageCache||n.isPageCache,isMemory:!!n.isMemory,checkbox:void 0===n.checkbox||n.checkbox,isHeadCheckbox:void 0===n.isHeadCheckbox||n.isHeadCheckbox,onCheckFn:n.onCheckFn||null,onRowFn:n.onRowFn||null,isSelectSingleRow:void 0!==n.isSelectSingleRow&&n.isSelectSingleRow,isOnRowCheckbox:!!n.isOnRowCheckbox,initSelected:n.initSelected||null,nullText:n.nullText?n.nullText:t.nullText,requestText:n.requestText?n.requestText:t.requestText,isSort:!!n.isSort,isSortCurrent:!!n.isSortCurrent,isShowLoading:void 0===n.isShowLoading||n.isShowLoading,countFont:n.countFont?n.countFont:t.countFont,refreshIndex:void 0!==n.refreshIndex&&n.refreshIndex,isHideColumns:void 0!==n.isHideColumns&&n.isHideColumns},o={data:[],tmpData:[],columns:[],rowSelected:[],detailSelected:[],width:0,browser:e.base.browser},r={tHeadCreateHtml:function(){var t=i.isHideColumns,n=i.columns,r=i.detail,l=i.checkbox,s=i.isHeadCheckbox,c=a.popup,d=a.grid1,u=a.grid2,p=a.isInit,f=0,h="",g="",v="";if(h+="<table>",h+='<tr class="l-grid-hd-row">',r&&(h+='<th class="l-grid-hd-cell l-grid-hd-detail"><div class="l-grid-row-cell-inner"><span class="l-grid-row-detailbtn"></span></div></th>'),l&&(h+='<th class="l-grid-hd-cell l-grid-hd-checkbox"><div class="l-grid-hd-cell-inner">',s&&(h+='<span class="l-checkbox l-grid-hd-checkbox"></span>'),h+="</div></th>"),h+="</tr>",h+="</table>",p&&!e.base.cookie.get(encodeURIComponent(location.pathname))&&(o.columns=n),t){n=o.columns;for(var m=0;m<i.columns.length;m++){for(var b="",w=0;w<n.length;w++)i.columns[m].display===n[w].display&&(b=" l-checkbox-selected");v+='<div class="l-grid-popup-item fn-clear"><span class="l-checkbox'+b+'"></span><span class="l-grid-popup-text">'+i.columns[m].display+"</span></div>"}c.html(v)}for(g+="<table>",g+='<tr class="l-grid-hd-row">';f<n.length;f++){var x=n[f],y=i.isSort&&x.isSort!==!1&&x.name?' data-columnName="'+x.name+'"':"",k=f===n.length-1?" l-grid-hd-cell-last":"";g+='<th class="l-grid-hd-cell'+k+'"><div class="l-grid-hd-cell-inner"><span class="l-grid-hd-cell-span"'+y+'><span class="l-grid-hd-cell-text">'+x.display+"</span></span></div></th>"}g+="</tr>",g+="</table>",p?(d.append('<div class="l-grid-header">'+h+"</div>"),u.append('<div class="l-grid-header">'+g+"</div>")):(d.find(".l-grid-header").html(h),u.find(".l-grid-header").html(g))},tBodyCreateHtml:function(t){var n=o.columns.length?o.columns:i.columns,r=n.length,l=i.statis,s=[],c=i.detail,d=i.checkbox,u=a.loding.is(":visible")?i.requestText:i.nullText,p=i.pageSize,f=(a.popup,a.grid),h=a.grid1,g=a.grid2,v=0,m="",b="",w=o.tmpData,x=i.data.total,y=i.data.rows,k=a.isInit,C=this;if(t=void 0!==t?t-1:0,d||c){if(m+="<table>",x&&y.length){for(var v=0;v<p;v++)w[t][v]&&(m+='<tr class="l-grid-row'+(v%2===0?"":" l-grid-row-even")+(C.initSelected(w[t][v])?" l-grid-row-selected":"")+'" data-row="'+v+'">',c&&(m+='<td><div class="l-grid-row-cell-inner"><span class="l-grid-row-detailbtn l-grid-row-detailbtn-close"></span></div></td>'),d&&(m+='<td><div class="l-grid-row-cell-inner"><span class="l-checkbox l-grid-row-checkbox"></span></div></td>'),m+="</tr>");if(l)for(var S=l.length,j=0;j<S;j++)m+='<tr class="l-grid-row l-grid-row-statis l-grid-row-'+l[j].type+'">',m+=d&&c?'<td style="width:13px"><div class="l-grid-row-cell-inner"></div></td><td style="width:13px"><div class="l-grid-row-cell-inner"></div></td>':'<td style="width:13px"><div class="l-grid-row-cell-inner"></div></td>',m+="</tr>"}else m+='<tr class="l-grid-row"><td></td></tr>';m+="</table>"}if(b+="<table>",x&&y.length){for(var T=0;T<r;T++)s[T]=[];for(var v=0;v<p;v++){var D=w[t][v],I=C.initSelected(D,v)?" l-grid-row-selected":"",F=v%2===0?"":" l-grid-row-even";if(D){b+='<tr class="l-grid-row'+F+I+'" data-row="'+v+'">';for(var A=0,M=0;M<r;M++){var E=n[M],H=M===r-1?" l-grid-row-cell-last":"",P=E.align?" l-grid-align-"+E.align:"",z=e.base.isFunction(E.statis),R=E.render;if(E.statisType){var q=parseFloat(D[E.name]);s[M][v]=isNaN(q)?0:q,A+=s[M][v],z&&(s[M][v]=A)}b+='<td class="l-grid-row-cell'+H+'" data-cell="'+M+'"><div class="l-grid-row-cell-inner'+P+'">',z&&(b+=void 0!==E.statisRender?E.statisRender(A):A),b+=e.base.isFunction(R)?R(D,v,D[E.name],M):D[E.name],b+="</div></td>"}if(b+="</tr>",c){var L=D.chlidren?D.chlidren:[],N=n.length+(d?1:0)+1;if(e.base.isFunction(c.render))b+='<tr class="l-grid-row-detail l-grid-row-detail'+v+F+I+'" data-row="'+v+'">',b+='<td colspan="'+N+'">'+c.render(L)+"</td>",b+="</tr>";else for(var O=0;O<L.length;O++){b+='<tr class="l-grid-row-detail l-grid-row-detail'+v+F+I+'" data-row="'+v+'">';for(var M=0;M<r;M++){var E=n[M];b+='<td class="l-grid-row-cell" data-cell="'+M+'"><div class="l-grid-row-cell-inner l-grid-align-'+(E.align?E.align:"left")+'">',b+=e.base.isFunction(E.detailRender)?E.detailRender(L[O],M,L[O][E.name],O):L[O][E.name]?L[O][E.name]:"",b+="</div></td>"}b+="</tr>"}}}}if(l)for(var S=l.length,j=0;j<S;j++){b+='<tr class="l-grid-row l-grid-row-statis l-grid-row-'+l[j].type+'">';for(var O=0;O<r;O++){var B=n[O],W=B.align?B.align:"left",_=B.statisWrap,Q=B.statisType,U=B.statisRender,X=O===r-1?" l-grid-row-cell-last":"";if(b+='<td class="l-grid-row-cell'+X+'"><div class="l-grid-row-cell-inner l-grid-align-'+W+'">',_)b+=l[j].display;else{for(var V=s[O],G=V.length,J=0,Y=0;Y<G;Y++)J+=V[Y];if(Q)for(var Z=Q,K=Z.split(","),ee=0,te=K.length,ne="";ee<te;ee++)if(l[j].type===K[ee]){switch(K[ee]){case"sum":ne=J;break;case"avg":ne=1*J/Y;break;case"min":ne=Math.min.apply(Math,V);break;case"max":ne=Math.max.apply(Math,V)}ne=ne.toFixed(i.statisToFixed),b+=e.base.isFunction(U)?U(ne):ne}}b+="</div></td>"}b+="</tr>"}}else b+='<tr class="l-grid-row"><td><div class="l-grid-row-cell-inner l-grid-align-center l-grid-nullText">'+u+"</div></td></tr>";b+="</table>",k?(h.append('<div class="l-grid-body">'+m+"</div>"),g.append('<div class="l-grid-body">'+b+"</div>")):(h.find(".l-grid-body").html(m),g.find(".l-grid-body").html(b)),f.off("mouseover",".l-grid-row, .l-grid-row-detail").on("mouseover",".l-grid-row, .l-grid-row-detail",function(){var e=this.getAttribute("data-row");f.find(".l-grid-row").eq(e).addClass("l-grid-row-hover"),g.find(".l-grid-row").eq(e).addClass("l-grid-row-hover"),g.find(".l-grid-row-detail"+e).addClass("l-grid-row-hover")}).off("mouseout",".l-grid-row, .l-grid-row-detail").on("mouseout",".l-grid-row, .l-grid-row-detail",function(){var e=this.getAttribute("data-row");h.find(".l-grid-row").eq(e).removeClass("l-grid-row-hover"),g.find(".l-grid-row").eq(e).removeClass("l-grid-row-hover"),g.find(".l-grid-row-detail"+e).removeClass("l-grid-row-hover")}),(d||c)&&(d&&c?h.width(68):h.width(34)),C.setCellWidth(),(d||c)&&C.setRowsHeight(),$(window).resize(function(){C.setCellWidth(),(d||c)&&C.setRowsHeight()}),i.isPageCache||i.isSortCurrent||(o.tmpData[i.pageIndex-1]=[])},pageCreateHtml:function(){var n=this,o="",r=i.data.total,l=i.pageIndex,s=i.pageSize,c=i.countFont,d=i.pageSizeOptions,u={getLink:function(e,t){return'<a href="javascript:;" data-page="'+e+'"'+(i.pageIndex===e?' class="current"':"")+">"+(t||e)+"</a>"},getCount:function(e,t,n){var a=(n-1)*e+1,o=n*e,r=i.countFont+"",l=Math.ceil(t/e),s=l*e-t;return r=r.replace("{{start}}",a),r=r.replace("{{end}}",l*e===o?o-s:o),r=r.replace("{{count}}",t),r=r.replace("{{size}}",e),r=r.replace("{{pageNum}}",l),r=r.replace("{{current}}",n)},getBtn:function(e,n,a){var i="",o=1,r=1,l=0,s=2,c=Math.ceil(n/e);for(i+=a>1?this.getLink(a-1,t.prevPage):'<span class="prev">'+t.prevPage+"</span>",a-s>1&&(i+=this.getLink(1)+"<span>...</span>",o=a-s),r=Math.min(c,o+2*s),r===c-1&&(r=c),l=o;l<=r;l++)i+=this.getLink(l);return r<c&&(i+="<span>...</span>"+this.getLink(c)),i+=a<c?this.getLink(a+1,t.nextPage):'<span class="next">'+t.nextPage+"</span> "},getPageSelect:function(t){if(!e.base.isArray(t))return!1;var n=i.pageSize,a=t.length,o=0,r="";for(r+='<select class="ui-select">';o<a;o++)r+='<option value="'+t[o]+'"'+(n===t[o]?' selected="selected"':"")+">"+t[o]+"</option>";return r+="</select>"}};r&&c&&(o+='<div class="l-grid-footer-page-msg">'+u.getCount(s,r,l)+"</div>"),r&&d&&(o+='<div class="l-grid-footer-page-select">'+u.getPageSelect(d)+"</div>"),r&&(o+='<div class="l-grid-footer-page-btn ui-pagination">'+u.getBtn(s,r,l)+"</div>"),a.page.html(o),n.initCheckbox()},bottomBtnsCreateHtml:function(){var t=i.bottomBtns,n=a.btnWrap;t&&n.html(function(){var e=t.length,n="",a=0,o=i.checkbox,r=i.detail;if(!e||!o)return n;for(n+=r?'<span class="l-checkbox l-grid-footer-checkbox l-grid-footer-checkbox-detail"></span>':'<span class="l-checkbox l-grid-footer-checkbox"></span>';a<e;a++){var l=t[a],s=l.cls?" "+l.cls:"";n+='<a href="javascript:;" class="ui-btn'+s+'" data-index="'+a+'"><span>'+l.text+"</span></a>"}return n}).off("click",".ui-btn").on("click"," .ui-btn",function(){var n=this.getAttribute("data-index"),a=t[n];e.base.isFunction(a.click)&&a.click.call(this)})},bottomBtnsFn:function(){var t=a.btnWrap,n=a.grid1.find(".l-checkbox");t.off("click",".l-checkbox").on("click",".l-checkbox",function(){var t=$(this);e.ui.onselectstart(t),n.trigger("click"),n.hasClass("l-checkbox-selected")?t.addClass("l-checkbox-selected"):t.removeClass("l-checkbox-selected")})},setCellWidth:function(){for(var e=o.columns.length?o.columns:i.columns,t=e.length,n=i.wrap.width(),r=a.grid,l=r.find(".l-sl-grid2"),s=a.grid1,c=i.checkbox,d=i.detail,u=c||d?s.outerWidth():0,p=a.grid2,f=0,h=0,g=i.isFixedWidth,v=function(n){var a=0;for(n=void 0===n?i.width:n;a<t;a++)p.find(".l-grid-hd-cell").eq(a).width(e[a].width),p.find(".l-grid-row-cell").eq(a).width(e[a].width);r.width(n),l.css({width:n-u,overflowX:"auto",marginRight:0}),p.css({width:h,marginLeft:0})},m=function(){for(var n=0,a=0;n<t;n++)a=e[n].width/h*100+"%",p.find(".l-grid-hd-cell").eq(n).width(a),p.find(".l-grid-row-cell").eq(n).width(a);r.width("100%"),l.css({position:"relative",width:r.width()-u-1,overflowX:"inherit",float:"left"}),p.css({width:"auto"})};f<t;f++)h+=e[f].width;"auto"===i.width?m():g?v():n>h||n<i.width?m():v(n)},setRowsHeight:function(){var e=a.grid1,t=a.grid2,n=i.statis?i.pageSize+i.statis.length:i.pageSize,r=0;if(e.find(".l-grid-hd-row").height(t.find(".l-grid-hd-row").outerHeight()),n)for(;r<n;r++){var l=e.find(".l-grid-row").eq(r),s=t.find(".l-grid-row").eq(r),c=t.find(".l-grid-row-detail"+r),d=s.outerHeight(),u=0;if(!d)return;for(var p=0;p<c.length;p++)u+=c[p].offsetHeight;o.browser.ie<=7?l.height(d+u-1):l.height(d+u)}else{var l=e.find(".l-grid-row").eq(0),s=t.find(".l-grid-row").eq(0),d=s.outerHeight();l.height(d)}},initSelected:function(t,n){var a=this,r=i.isMemory,l=i.initSelected,s=i.pageIndex,c=o.rowSelected[s-1];return!!(t&&e.base.isFunction(l)&&l(t))&&(r&&void 0!==n&&(c[n]=a.getRowData(n),a.initCheckbox()),!0)},pageFn:function(){var t=this,n=a.page,r=a.grid1,l=r.find(".l-gird-header"),s=r.find(".l-gird-body"),c=i.pageSize,d=i.onPageFn,u=i.pageSizeOptions;n.off("click","a").on("click","a",function(){var n=Number($(this).attr("data-page"));i.pageIndex=n,e.base.isFunction(d)&&d(n,c),o.tmpData[n-1]&&o.tmpData[n-1].length&&o.tmpData.length?(t.tBodyCreateHtml(n),t.pageCreateHtml()):t.getData(),s.find(".l-checkbox-selected").length===c?l.find(".l-checkbox").addClass("l-checkbox-selected"):l.find(".l-checkbox").removeClass("l-checkbox-selected"),t.initCheckbox()}),u&&n.off("change","select").on("change","select",function(){o.tmpData=[],i.pageSize=Number(this.value),i.pageIndex=1,a.refresh()})},initCheckbox:function(){var e=i.pageSize,t=i.pageIndex,n=a.grid1,r=n.find(".l-grid-header"),l=n.find(".l-grid-body"),s=l.find(".l-checkbox"),c=r.find(".l-checkbox"),d=a.btnWrap.find(".l-checkbox"),u=i.isMemory;if(u){for(var p=Math.min(e,s.length),f=o.rowSelected[t-1],h=f?f.length:0,g=0,v=0;g<h;g++,v++)f[g]&&s.eq(v).addClass("l-checkbox-selected");l.find(".l-checkbox-selected").length===p?(c.addClass("l-checkbox-selected"),d.addClass("l-checkbox-selected")):(c.removeClass("l-checkbox-selected"),d.removeClass("l-checkbox-selected"))}else o.rowSelected=[],c.removeClass("l-checkbox-selected"),d.removeClass("l-checkbox-selected")},checkboxFn:function(){var t=this,n=a.grid1,r=a.grid2,l=n.find(".l-grid-header"),s=n.find(".l-grid-body"),c=r.find(".l-grid-body"),d=i.onCheckFn,u=i.pageSize,p=a.btnWrap;s.off("click",".l-checkbox").on("click",".l-checkbox",function(){var n=$(this),a=i.pageIndex,r=s.find(".l-checkbox"),f=r.index(n),h=Math.min(u,r.length),g=o.rowSelected[a-1],v=s.find(".l-grid-row").eq(f),m=c.find(".l-grid-row").eq(f),b=m.next(".l-grid-row-detail"),w=o.tmpData[i.pageIndex-1];return!(e.base.isFunction(d)&&!d.apply(this,[w[f],v,m]))&&void(n.hasClass("l-checkbox-selected")?(g[f]=null,n.removeClass("l-checkbox-selected"),v.removeClass("l-grid-row-selected"),m.removeClass("l-grid-row-selected"),b.removeClass("l-grid-row-selected"),l.find(".l-checkbox").removeClass("l-checkbox-selected"),p.find(".l-checkbox").removeClass("l-checkbox-selected")):(n.addClass("l-checkbox-selected"),v.addClass("l-grid-row-selected"),m.addClass("l-grid-row-selected"),b.addClass("l-grid-row-selected"),g[f]=t.getRowData(f),s.find(".l-checkbox-selected").length===h&&(l.find(".l-checkbox").addClass("l-checkbox-selected"),p.find(".l-checkbox").addClass("l-checkbox-selected"))))}),l.off("click",".l-checkbox").on("click",".l-checkbox",function(n){n.stopPropagation();var a=$(this),r=i.pageIndex,l=o.rowSelected[r-1],u=s.find(".l-checkbox"),f=s.find(".l-grid-row"),h=c.find(".l-grid-row"),g=h.next(".l-grid-row-detail"),v=u.length,m=0,b=v-1,w=o.tmpData[i.pageIndex-1];if(e.base.isFunction(d)&&!d(w,f,h))return!1;if(a.hasClass("l-checkbox-selected"))for(a.removeClass("l-checkbox-selected"),u.removeClass("l-checkbox-selected"),f.removeClass("l-grid-row-selected"),h.removeClass("l-grid-row-selected"),g.removeClass("l-grid-row-selected"),p.find(".l-checkbox").removeClass("l-checkbox-selected");b>-1;b--)l[b]=null;else for(a.addClass("l-checkbox-selected"),f.addClass("l-grid-row-selected"),h.addClass("l-grid-row-selected"),g.addClass("l-grid-row-selected"),u.addClass("l-checkbox-selected"),p.find(".l-checkbox").addClass("l-checkbox-selected");m<v;m++)l[m]=t.getRowData(m)})},getRowData:function(e){var t=i.pageIndex,n=o.tmpData[t-1];return e!==-1&&n[e]},detailBtnFn:function(e){var t=a.grid1,n=a.grid2,o=t.find(".l-grid-body"),r=n.find(".l-grid-body");i.pageSize;o.off("click",".l-grid-row-detailbtn").on("click",".l-grid-row-detailbtn",function(){var e=$(this),t=e.parents(".l-grid-row"),n=t.attr("data-row"),a=r.find(".l-grid-row").eq(n),i=r.find(".l-grid-row-detail"+n),o=0;if(e.hasClass("l-grid-row-detailbtn-close")){i.show(),e.removeClass("l-grid-row-detailbtn-close").addClass("l-grid-row-detailbtn-open");for(var l=0;l<i.length;l++)o+=i[l].offsetHeight;t.height(a[0].offsetHeight+o)}else i.hide(),e.removeClass("l-grid-row-detailbtn-open").addClass("l-grid-row-detailbtn-close"),t.height(a[0].offsetHeight)})},setAjaxCookieData:function(){},ajaxGetData:function(t){var n=i.pageAjax,o=void 0===n.type?"GET":n.type,r=i.showAllRow,l=i.pageIndex,s=i.pageSize,c="",d=i.isShowLoading,u=[],p="",f=encodeURIComponent(location.pathname+"getGridPrev"),h=function(e){var t,n,a,i,o={};t=e.split("&");for(var r=0;r<t.length;r++)n=t[r].split("="),a=n[0],i=n[1],""===a&&(a="unkown"),"undefined"==typeof o[a]?o[a]=i:"string"==typeof o[a]?(o[a]=[o[a]],o[a].push(i)):o[a].push(i);return o};if("string"==typeof n.data)c=n.data,c+="&pageIndex="+l,c+="&pageSize="+s,u=c.replace(/{{|}}/g,"");else if("object"==typeof n.data||!n.data){c=$.extend({},n.data),c.pageSize=i.pageSize,c.pageIndex=i.pageIndex;for(p in c)u.push(p+"="+c[p]);u=u.join("&")}a.isInit||e.base.cookie.set(f,u,2e5),/getGridPrev/.test(location.search)?(u=e.base.cookie.get(f)?e.base.cookie.get(f):u,i.pageIndex=Number(h(u).pageIndex)):e.base.cookie.set(f,u,2e5),$.ajax({type:o,url:n.url,cache:!1,dataType:"json",data:u,beforeSend:function(){e.base.isFunction(n.beforeSend)&&n.beforeSend(),d&&a.loding.fadeIn().removeClass("fn-hide"),a.onLoaded=!1},success:function(o){e.base.isFunction(n.success)&&n.success(o),e.base.isFunction(t)&&setTimeout(function(){t(o),d&&a.loding.fadeOut()},500),r&&(i.pageSize=o?o.total:0,i.isPage=!1),a.onLoaded=!0;
},error:function(e){t(),a.loding.fadeOut(),a.jump(e)}})},getData:function(){var e=this;i.pageAjax&&(i.data={rows:[],total:0},e.ajaxGetData(function(t){i.data=t=t&&t.rows&&t.total?t:i.data,e.handleData(!1),e.tBodyCreateHtml(i.pageIndex),e.pageCreateHtml(),void 0!==t.total&&a.grid2.find(".l-grid-nullText").html(i.nullText)}))},setCacheColumns:function(){var t=i.columns,n=t.length,a=0,r=0,l=e.base.cookie.get(encodeURIComponent(location.pathname)),s=l.split(","),c=s.length;for(l&&(o.columns=[]);a<n;a++)for(var d=0;d<c;d++)t[a].display===s[d]&&(o.columns[r]=t[a],r++)},handleData:function(e){var t=this,n=i.data=i.data&&i.data.rows&&i.data.total?i.data:{rows:[],total:0},a=i.pageAjax,r=i.pageSize,l=i.pageIndex,s=Math.ceil(n.total/r),c=0,d=[];for(e=void 0==e||e,e&&t.getData();c<s;c++)if(o.rowSelected[c]||(o.rowSelected[c]=[]),!a){var u=0;for(d[c]=[];u<r;u++){var p=n.rows[r*c+u];p&&(d[c][u]=p)}}a?o.tmpData[l-1]=i.data.rows:o.tmpData=d,i.isHideColumns&&t.setCacheColumns()},compareData:function(e,t){function n(e){return function(t,n){var a=0;if(null!==t[e]&&null!==n[e]){var i=t[e],o=n[e],r=parseFloat(i),l=parseFloat(o);a=isNaN(l)||isNaN(r)?i.length===o.length?i.localeCompare(o):i.length>o.length?1:-1:r>l?1:-1}return a}}var a=i.pageIndex-1,r=o.tmpData[a];r.length;return r.sort(n(e)),"desc"===t&&r.reverse(),o.tmpData[a]=r,r},tHeadFn:function(){var t=this,n=(i.pageSize,i.pageIndex,a.grid1),o=a.grid2,r=(n.find(".l-grid-header"),n.find(".l-grid-body"),o.find(".l-grid-header")),l=(o.find(".l-grid-body"),i.isSort),s=i.isSortCurrent,c=a.popup,d=i.isHideColumns,u=!0;l&&(r.find(".l-grid-hd-cell-span").addClass(function(){var e=$(this),t=e.parents(".l-grid-hd-cell");e.attr("data-columnName")&&(e.addClass("l-grid-hd-cell-sortWrap").append('<span class="l-grid-hd-cell-sort"><b class="icon icon-angle-up"></b></span>'),t.addClass("l-grid-hd-cell-sort"))}),r.off("click",".l-grid-hd-cell-sortWrap").on("click",".l-grid-hd-cell-sortWrap",function(){var n=$(this),o=n.attr("data-columnName"),r="",l=n.find(".l-grid-hd-cell-sort");e.ui.onselectstart(n),s?(l.hasClass("desc")?(l.html('<b class="icon icon-angle-up"></b>'),l.removeClass("desc"),r="desc"):(l.html('<b class="icon icon-angle-down"></b>'),l.addClass("desc"),r="asc"),t.compareData(o,r),t.tBodyCreateHtml()):a.onLoaded&&(l.hasClass("desc")?(l.html('<b class="icon icon-angle-up"></b>'),l.removeClass("desc"),r="desc"):(l.html('<b class="icon icon-angle-down"></b>'),l.addClass("desc"),r="asc"),"string"==typeof i.pageAjax.data?/&sort=/.test(i.pageAjax.data)?(i.pageAjax.data=i.pageAjax.data.replace(/&sort={{\w*}}/,"&sort={{"+o+"}}"),i.pageAjax.data=i.pageAjax.data.replace(/&sortType={{\w*}}/,"&sortType={{"+r+"}}")):i.pageAjax.data=i.pageAjax.data+"&sort={{"+o+"}}&sortType={{"+r+"}}":"object"==typeof i.pageAjax.data?(i.pageAjax.data.sort=o,i.pageAjax.data.sortType=r):(i.pageAjax.data={},i.pageAjax.data.sort=o,i.pageAjax.data.sortType=r),t.handleData(),t.tBodyCreateHtml())})),d&&(r.off("contextmenu",".l-grid-hd-cell").on("contextmenu",".l-grid-hd-cell",function(t){var n=($(t.currentTarget),a.popup),i=n.outerWidth(),o=a.grid,r=o.outerWidth(),l=a.grid.offset().left,s=e.ui.mousePosition(t),c=s.positionX-l;return r-c>i?n.css({left:c}):n.css({left:c-i}),u=!0,n.show(),!1}),c.off("click").on("click",function(e){u=!0,e.stopPropagation()}).off("click",".l-checkbox").on("click",".l-checkbox",function(n){var a=$(n.currentTarget);if(a.hasClass("l-checkbox-selected")){if(c.find(".l-checkbox-selected").length<=1)return!1;a.removeClass("l-checkbox-selected")}else a.addClass("l-checkbox-selected");for(var i=c.find(".l-checkbox-selected").next(),o=i.length,r=0,l=[];r<o;r++)l[r]=i.eq(r).html();e.base.cookie.set(encodeURIComponent(location.pathname),l.join(),2e5),t.setCacheColumns(),t.tHeadCreateHtml(),t.tBodyCreateHtml(),n.stopPropagation()}).off("click",".l-grid-popup-text").on("click",".l-grid-popup-text",function(t){var n=$(t.currentTarget);n.prev().trigger("click"),e.ui.onselectstart(n),t.stopPropagation()}),$(window).on("click",function(){u&&(c.hide(),u=!1)}))},rowFn:function(){var t=this,n=a.grid1,r=a.grid2,l=n.find(".l-grid-body"),s=(r.find(".l-grid-header"),r.find(".l-grid-body")),c=(i.onCheckFn,i.pageSize,i.onRowFn),d=i.isOnRowCheckbox,u=i.isSelectSingleRow,p=e.base.isFunction(c);s.off("mouseover",".l-grid-row-cell").on("mouseover",".l-grid-row-cell",function(){var e=$(this),t=e.attr("data-cell");e.parent().attr("data-cell",t)}),s.off("click",".l-grid-row").on("click",".l-grid-row",function(){var e=$(this),n=i.pageIndex,a=e.next(".l-grid-row-detail"),r=e.attr("data-row"),s=o.rowSelected[n-1],f=l.find(".l-grid-row").eq(r),h=l.find(".l-checkbox").eq(r);e.hasClass("l-grid-row-selected")?(u||(e.removeClass("l-grid-row-selected"),a.removeClass("l-grid-row-selected"),f.removeClass("l-grid-row-selected")),d&&h.removeClass("l-checkbox-selected")):(c&&!u||(e.siblings().removeClass("l-grid-row-selected"),f.siblings().removeClass("l-grid-row-selected")),d&&h.addClass("l-checkbox-selected"),e.addClass("l-grid-row-selected"),a.addClass("l-grid-row-selected"),f.addClass("l-grid-row-selected")),p&&(e.hasClass("l-grid-row-selected")?o.rowSelected[n-1][r]=null:s[r]=t.getRowData(r),c(t.getRowData(r),e))})},cellFn:function(){var t=a.grid1,n=a.grid2,o=(t.find(".l-grid-body"),n.find(".l-grid-header"),n.find(".l-grid-body"),i.onCheckFn,i.pageSize,i.onRowFn);i.isOnRowCheckbox,e.base.isFunction(o)},run:function(t){var n=this;t=void 0===t||t,n.handleData(t),i.isHead&&(n.tHeadCreateHtml(),n.tHeadFn()),n.tBodyCreateHtml(),a.isInit&&(n.rowFn(),n.checkboxFn(),n.detailBtnFn(),a.isInit=!1,e.ui.onselectstart(a.grid1)),i.isPage||i.bottomBtns?(i.isPage&&(n.pageCreateHtml(),n.pageFn()),i.bottomBtns&&(n.bottomBtnsCreateHtml(),n.bottomBtnsFn())):a.footer.remove()},init:function(){var e=i.wrap.append('<div class="l-grid" id='+i.id+"></div>").find("#"+i.id),t=e.append('<div class="l-grid-loading fn-hide"><div class="l-grid-loadingBg"></div><div class="l-grid-loadingIco"></div></div>').find(".l-grid-loading"),n=e.append('<div class="l-grid-popup"></div>').find(".l-grid-popup"),o=e.append('<div class="l-grid-body fn-clear"></div>').find(".l-grid-body"),r=o.append('<div class="l-grid1"></div>').find(".l-grid1"),l=o.append('<div class="l-sl-grid2"><div class="l-grid2"></div></div>').find(".l-grid2"),s=e.append('<div class="l-grid-footer"></div>').find(".l-grid-footer"),c=s.append('<div class="l-grid-footer-btns"></div>').find(".l-grid-footer-btns"),d=s.append('<div class="l-grid-footer-page"></div>').find(".l-grid-footer-page");return i.pageIndex=1,a.loding=t,a.popup=n,a.grid=e,a.grid1=r,a.grid2=l,a.footer=s,a.page=d,a.btnWrap=c,a.isInit=!0,a.onLoaded=!1,this.run(),a}};return a.refresh=function(e){if(e)for(var t in e)if(e.hasOwnProperty(t)&&void 0!==e[t])if(i.pageAjax&&e.pageAjax)for(var n in e.pageAjax)i[t][n]=e.pageAjax[n];else i[t]=e[t];return e&&!e.refreshIndex&&(i.pageIndex=1),o.tmpData=[],o.rowSelected=[],o.detailSelected=[],r.run(),a},a.getColumns=function(){return o.columns.length?o.columns:i.columns},a.reSetColumns=function(e){i.columns=o.columns=e.columns,r.run(!1)},a.changeHeaderText=function(e,t){var n=a.grid2,i=isNaN(Number(e));if(i)for(var o=n.find(".l-grid-hd-cell-span"),r=o.length,l=0;l<r;l++)o.eq(l).attr("data-columnname")===e&&o.eq(l).find(".l-grid-hd-cell-text").html(t);else n.find(".l-grid-hd-cell-text").eq(e).html(t);return a},a.getCurrentData=function(){var e=i.pageIndex;return o.tmpData[e-1]},a.getCurrentAllData=function(){return i.data},a.getSelectData=function(){for(var e=[],t=0,n=o.rowSelected,a=n.length,i=0;t<a;t++)if(n[t])for(var r=0;r<n[t].length;r++)n[t][r]&&e.push(n[t][r]);return i=e.length,{rows:e,total:i}},a.getPageIndex=function(){return i.pageIndex},a.uncheckRowByID=function(e){function t(){for(var t=o.rowSelected,n=t.length,a=0;a<n;a++)if(t[a])for(var i=t[a],r=i.length,l=0;l<r;l++)if(i[l]&&i[l].id==e)return i[l]=null,l}if(void 0!==e){var n=a.grid1,i=a.grid2,l=n.find(".l-grid-header"),s=n.find(".l-grid-body"),c=i.find(".l-grid-body"),d=t(),u=s.find(".l-grid-row").eq(d),p=c.find(".l-grid-row").eq(d),f=s.find(".l-checkbox").eq(d);f.removeClass("l-checkbox-selected"),u.removeClass("l-grid-row-selected"),p.removeClass("l-grid-row-selected"),l.find(".l-checkbox").removeClass("l-checkbox-selected"),r.initCheckbox()}return a},a.resetStatisToFixed=function(e){i.statisToFixed=e},a.jump=function(e){return console.log("ajax data error:",e),!1},a.methos=a.methos||{},r.init(n)};return function(e){return new a(e)}}),function(e,t){"function"==typeof define&&define.amd?define("core/pagination",["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):e.pagination=t(e.jQuery)}(this,function(e){"use strict";var t=function(e){this.cur=e.cur||1,this.total=void 0===e.total?10:e.total,this.len=e.len?e.len:5,this.prevText=e.prevText||"上一页",this.nextText=e.nextText||"下一页",this.target=e.target||"",this.callback=e.callback||function(){},this.target&&("string"==typeof this.target&&(this.target=document.getElementById(this.target)),this.init(),this.click(this.callback))};return t.prototype.init=function(){var e="",t='<a href="javascript:;" data-index="{{num}}">{{num}}</a>',n='<a href="javascript:;" data-index="{{num}}">{{num}}</a>',a='<a href="javascript:;" class="prev" data-index="{{num}}">'+this.prevText+"</a>",i='<a href="javascript:;" class="next" data-index="{{num}}">'+this.nextText+"</a>",o='<span class="prev">'+this.prevText+"</span>",r='<span class="next">'+this.nextText+"</span>",l='<span class="current">{{num}}</span>',s='<a href="javascript:;" class="" data-index="{{num}}">{{num}}</a>',c="<span>...</span>",d=function(e,t){return e.replace(/{{num}}/g,t)},u=3;if(this.len>=3&&(u=Math.round(this.len/2)),e+=this.cur>=2?d(a,this.cur-1):o,this.cur>=4&&this.total>=this.len+1&&(e+=d(t,1),e+=c),this.len>=this.total)for(var p=1;p<=this.total;p++)e+=d(p===this.cur?l:s,p);else for(var p=1,f=!1,h=0;p<=this.len;p++)this.cur<u?(p===this.cur&&(f=!0),h=p):this.total-this.cur<u?(this.len-(this.total-this.cur)===p&&(f=!0),h=this.total-this.len+p):(p===u&&(f=!0),h=this.cur-u+p),e+=d(f?l:s,h),f=!1;this.total-this.cur>=u&&this.total>=this.len+1&&this.cur+this.len-u!==this.total&&(e+=c,e+=d(n,this.total)),e+=this.total-this.cur>=1?d(i,this.cur+1):r,this.target.innerHTML=e},t.prototype.click=function(e){for(var t=this,n=this.target.getElementsByTagName("a"),a=n.length-1;a>=0;a--)n[a].onclick=function(){t.cur=Number(this.getAttribute("data-index")),t.init(),t.click(e),e.apply(this,[t.cur,t.total])}},function(e){return e?new t(e):{}}}),define("core/gridFree",["core/cncnERP","template","core/pagination"],function(e,t,n){"use strict";var a={template:null,nullTemplate:null,wrap:null,pageIndex:1,pageSize:10,pageSizeOptions:[10,20,50,100,200],data:{},pageAjax:{type:"GET",dataType:"json",success:function(){},error:function(){},beforeSend:function(){}},isShowLoading:!0,onRowFn:function(){},bottomBtns:{},statis:[],statisToFixed:2,renderBefore:function(){}},o={data:{},tmpData:[],ele:{},isInit:!0,fragment:{loading:'<div class="l-gridFree-loading"><div class="l-grid-loadingBg"></div><div class="l-grid-loadingIco"></div></div>',pagination:'<div class="l-gridFree-footer-page ui-pagination"></div>',pageSelect:'<div class="l-gridFree-footer-select"></div>',bottomBtns:'<div class="l-gridFree-footer-btn"></div>',nullWrap:a.nullTemplate?t(a.nullTemplate,{cls:"l-gridFree-body-nullWrap"}):'<div class="l-gridFree-body-nullWrap"></div>'}},r={ajax:function(t){var n=a.pageAjax,r=(void 0===n.type?"GET":n.type,a.pageIndex),l=a.pageSize,s="",c=(a.isShowLoading,[]),d=encodeURIComponent(location.pathname+"getGridPrev"),u=function(e){var t,n,a,i,o={};t=e.split("&");for(var r=0;r<t.length;r++)n=t[r].split("="),a=n[0],i=n[1],""===a&&(a="unkown"),"undefined"==typeof o[a]?o[a]=i:"string"==typeof o[a]?(o[a]=[o[a]],o[a].push(i)):o[a].push(i);return o};if("string"==typeof n.data)s=n.data,s+="&pageIndex="+r,s+="&pageSize="+l,c=s.replace(/{{|}}/g,"");else if("object"==typeof n.data||!n.data){s=$.extend({},n.data),s.pageSize=a.pageSize,s.pageIndex=a.pageIndex;for(i in s)c.push(i+"="+s[i]);c=c.join("&")}o.isInit||e.base.cookie.set(d,c,2e5),/getGridPrev/.test(location.search)?(c=e.base.cookie.get(d)?e.base.cookie.get(d):c,a.pageIndex=Number(u(c).pageIndex)):e.base.cookie.set(d,c,2e5),$.ajax({type:a.pageAjax.type,url:a.pageAjax.url,cache:!1,dataType:a.pageAjax.dataType,data:c,beforeSend:function(){o.ele.loading.style.display="block"},success:function(e){o.data=e,o.tmpData[a.pageIndex-1]=e.rows,setTimeout(function(){t(),a.pageAjax.success(e),a.isShowLoading&&(o.ele.loading.style.display="none")},500)},error:function(e){o.tmpData[a.pageIndex-1]=[],o.total=0,t(),a.pageAjax.error(e),console.log(e),setTimeout(function(){o.ele.loading.style.display="none"},500)}})},createWrap:function(e){var t=document.getElementById(e),n=null,a=null,i=o.fragment;return t.children.length||(t.innerHTML='<div class="l-gridFree">'+i.loading+'<div class="l-gridFree-body">'+i.nullWrap+'</div><div class="l-gridFree-footer">'+i.bottomBtns+i.pageSelect+i.pagination+"</div></div>"),n=t.firstChild.children,a=n[2],{wrap:t,loading:n[0],body:n[1],footer:a,bottomBtns:a.children[0],pageSelect:a.children[1],pagination:a.children[2]}},createBody:function(){var e=o.tmpData[a.pageIndex-1],n=a.renderBefore(o.data);n=n?n:o.data;for(var i=0,r=a.templateRender.length;i<r;i++)t.helper(a.templateRender[i].name,a.templateRender[i].handle);o.data.rows=e,o.ele.body.innerHTML=e.length?t(a.template,n):o.fragment.nullWrap},createFooter:function(){o.tmpData[a.pageIndex-1].length?o.ele.footer.style.display="":o.ele.footer.style.display="none";var e="",t=a.pageSize,i=a.pageSizeOptions;if(i.length){e+='<select class="ui-select">';for(var l=0,s=i.length,c=o.ele.pageSelect;l<s;l++)e+='<option value="'+i[l]+'"'+(t===i[l]?' selected="selected"':"")+">"+i[l]+"</option>";e+="</select>",c.innerHTML=e,c.firstChild.onchange=function(){a.pageSize=Number(this.value),a.pageIndex=1,o.tmpData=[],r.ajax(function(){r.createBody(),r.createFooter()})}}n({cur:a.pageIndex,total:Math.ceil(o.data.total/t),target:o.ele.pagination,prevText:"&lt;",nextText:"&gt;",callback:function(e,t){a.pageIndex=e,o.tmpData[a.pageIndex-1]?r.createBody():r.ajax(function(){r.createBody()})}})},compareData:function(e,t,n){function i(e){return function(t,n){var a=0;if(null!==t[e]&&null!==n[e]){var i=t[e],o=n[e],r=parseFloat(i),l=parseFloat(o);a=isNaN(l)||isNaN(r)?i.length===o.length?i.localeCompare(o):i.length>o.length?1:-1:r>l?1:-1}return a}}var l=a.pageIndex-1,s=o.tmpData[l];s.sort(i(e)),"desc"===t&&s.reverse(),o.tmpData[l]=s,r.createBody(),n()},compareAllData:function(e,t,n){"string"==typeof a.pageAjax.data?/&sort=/.test(a.pageAjax.data)?(a.pageAjax.data=a.pageAjax.data.replace(/&sort={{\w*}}/,"&sort={{"+e+"}}"),a.pageAjax.data=a.pageAjax.data.replace(/&sortType={{\w*}}/,"&sortType={{"+t+"}}")):a.pageAjax.data=a.pageAjax.data+"&sort={{"+e+"}}&sortType={{"+t+"}}":"object"==typeof a.pageAjax.data?(a.pageAjax.data.sort=e,a.pageAjax.data.sortType=t):(a.pageAjax.data={},a.pageAjax.data.sort=e,a.pageAjax.data.sortType=t),r.ajax(function(){r.createBody(),n()})}},l=function(e){a=$.extend(!0,a,e),a.wrap&&(o.ele=$.extend({},o.ele,r.createWrap(a.wrap)),r.ajax(function(){r.createBody(),r.createFooter(),o.isInit=!1}))};return l.prototype.refresh=function(e){return a=$.extend(!0,a,e),o.tmpData=[],r.ajax(function(){r.createBody(),r.createFooter()}),this},l.prototype.getPageIndex=function(){return a.pageIndex},l.prototype.getCurrentData=function(){return o.data},l.prototype.getRowData=function(e){return o.data.rows[e]},l.prototype.sort=function(e){if(e&&e.sort){var t=e.sort,n=e.sortType||"asc",a=void 0===e.isSortCurrent||e.isSortCurrent,i=e.callback||function(){};a?r.compareData(t,n,i):r.compareAllData(t,n,i)}},l.prototype.setRowSelected=function(e){},l.prototype.delRowSelected=function(e){},l.prototype.getRowSelected=function(e){},function(e){return new l(e)}}),define("app/cncnERP",["require","core/cncnERP","template","core/validator","core/drag","core/dialog","core/pop","core/tab","core/upload","core/grid","core/gridFree"],function(e){var t=e("core/cncnERP");return t.template=e("template"),t.ui.validator=e("core/validator"),saogaUI.ui.drag=e("core/drag"),saogaUI.ui.dialog=e("core/dialog"),saogaUI.ui.pop=e("core/pop"),saogaUI.ui.tab=e("core/tab"),saogaUI.ui.upload=e("core/upload"),saogaUI.ui.grid=e("core/grid"),saogaUI.ui.gridFree=e("core/gridFree"),t}),define("app/common",["require","../app/cncnERP"],function(e){"use strict";var t=e("../app/cncnERP"),n=!1;$(".nav_dl .link").on("click",function(){var e=$(this),t=e.parent("dt");t.siblings("dd").slideToggle(),e.parents("dl").addClass("cur").siblings().children("dd").slideUp(),e.parents("dl").siblings().removeClass("cur")}),$(".subLink").each(function(){var e=$(this),t=null;e.hasClass("cur")&&(t=e.parent("dd"),t.show(),t.parent().addClass("cur"),e.attr("href")===location.pathname&&t.find(".cur").length>1&&(t.find(".cur").removeClass("cur"),e.addClass("cur")))}),$(".lt-right").off("click",".ertong").on("click",".ertong",function(e){$(".alertBox .tip").hide(),$(this).find(".tip").show(),n=!0,e.stopPropagation()}),$(window).on("click",function(){n&&($(".alertBox .tip").hide(),n=!1)}),$(document).on("click",".integer_number,.float_number",function(){$(this).data("default_value",$(this).val())}),$(document).on("keyup",".integer_number",function(){if(""!=$(this).val()&&!/^[\d]+$/.test($(this).val()))return $(this).val($(this).data("default_value")),!1}),$(document).on("keyup",".float_number",function(){if(""!=$(this).val()&&isNaN($(this).val()))return $(this).val($(this).data("default_value")),!1}),window.gridOperating&&console.log("gridOperating 已在全局定义"),window.gridOperating=function(e,t){for(var n="",a=e.getCurrentAllData().operating,i=function(e,t){var n=null,a=e.url,i=[],o=null;a.replace(/{{(\w{0,})}}/g,function(e,t){i.push(t)});for(var r=0,l=i.length;r<l;r++)o=i[r],n=new RegExp("{{"+o+"}}","g"),a=a.replace(n,t[o]);return a},o=0,r=a.length;o<r;o++)n+='<a href="'+i(a[o],t)+'" class="'+a[o].cls+'">'+a[o].title+"</a>";return n},$(".nav dl dd").each(function(){$(this).find("a").size()<1&&$(this).parents("dl").remove()}),window.submit_form=function(e){var n=e.closest("form"),a=n.attr("action");if(""!=a){e.data("action");if(e.data("action",1),arguments.length>1){var i=arguments[1],o=arguments[2];if(o){var r="";for(var l in o)r+="<input type='hidden' class='append_hidden_input' name='"+l+"' value='"+o[l]+"'/>";n.append(r)}}$.post(a,n.serialize(),function(n){if(e.data("action",0),$(".append_hidden_input").remove(),0==n.res)t.ui.dialog.alert({title:"操作提示",text:n.msg,width:500});else{var a=n.data;"function"==typeof i?i.apply(window,[a,n]):t.ui.dialog.alert({title:"操作提示",text:n.msg,width:500})}},"json")}},$(".searchSubmit").click(function(){$(this).closest("form").submit()}),$(document).on("change",".choose_province",function(){var e=$(this).val();if(e){$(".choose_city option").not(":first").remove(),$(".choose_region option").not(":first").remove();var t=$(".choose_city").data("choose");$.get("/common/get_citys",{province_id:e},function(e){var n="";if(1==e.res){for(var a in e.data){var i="";t==e.data[a].zone_id&&(i='selected="selected"'),n+="<option value='"+e.data[a].zone_id+"' "+i+">"+e.data[a].zone_name+"</option>"}$(".choose_city").append(n),t>0&&$(".choose_region").size()>0&&$(".choose_city").trigger("change")}},"json")}}),$(document).on("change",".choose_city",function(){var e=$(this).val();if(e){$(".choose_region option").not(":first").remove();var t=$(".choose_region").data("choose");$.get("/common/get_regions",{city_id:e},function(e){var n="";if(1==e.res){for(var a in e.data){var i="";t==e.data[a].zone_id&&(i='selected="selected"'),n+="<option value='"+e.data[a].zone_id+"' "+i+">"+e.data[a].zone_name+"</option>"}$(".choose_region").append(n)}},"json")}}),$(".checkAll").click(function(){var e=$(this).data("target"),t=$(this).is(":checked");$("[name='"+e+"']").each(function(){1==$(this).data("valid")&&$(this).prop("checked",t)}),$(".checkAll").prop("checked",$(this).is(":checked"))}),$(document).on("click",".go_back",function(){window.history.go(-1)})}),$(document).on("click",".date_picker",function(){WdatePicker(),console.log("test")}),function(e,t){"function"==typeof define&&define.amd?define("app/anchorChain",["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(e.jQuery)}(this,function(e){"use strict";var t=e(window),n=e("html, body"),a={setFixed:function(e,t){e.css({position:"fixed",top:t,zIndex:"999"})},removeFixed:function(e){e.removeAttr("style")},setCurrerClass:function(e){e.addClass("cur").siblings().removeClass("cur")}};e.fn.anchorChain=function(i){var o=e.extend({},{wrap:"",position:0,isNav:!0},i);e(this).each(function(i){var r,l,s,c,d,u,p=o.isNav?e(o.wrap):e(o.wrap).eq(i);p.length&&(r=e(this),l=r.offset().top,s=r.outerHeight(),c=r.children(),d=p.offset().top,u=p.parent().outerHeight(),o.isNav&&c.on("click",function(){var t=(e(this),this.getAttribute("data-index")),a=p.eq(t),i=a.length&&a.offset().top-o.position;a.length&&n.animate({scrollTop:i},500)}),t.on("scroll",function(t){var n=e(this).scrollTop(),i=o.isNav?d-s:d;p.each(function(t){n>e(this).offset().top-s+1&&a.setCurrerClass(c.eq(t))}),n>=i&&n+s+o.position<u+l?a.setFixed(r,o.position):a.removeFixed(r)}))})}}),function(e,t){"function"==typeof define&&define.amd?define("app/wordsNumber",["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(e.jQuery)}(this,function(e){"use strict";e.fn.wordsNumber=function(t){var n=this,a=n.parent().find(t.textNum),i=(n.val().length,parseInt(n.attr("maxlength"),10)-n.val().length);a.html(i),n.each(function(t){var n=e(this);n.keyup(function(){var e=parseInt(n.attr("maxlength"),10);if(e>0){n.val().length>e&&n.val(n.val().substr(0,e));var t=e-n.val().length;a.html(t)}}),n.blur(function(){var e=parseInt(n.attr("maxlength"),10);if(e>0){n.val().length>e&&n.val(n.val().substr(0,e));var t=e-n.val().length;a.html(t)}})})}}),function(e,t){"function"==typeof define&&define.amd?define("app/baguetteBox",t):"object"==typeof exports?module.exports=t():e.baguetteBox=t()}(this,function(){function e(e,n){z.transforms=v(),z.svg=m(),a(),t(e,n)}function t(e,t){O=document.querySelectorAll(e),[].forEach.call(O,function(e){t&&t.filter&&(N=t.filter);var n=e.getElementsByTagName("a");n=[].filter.call(n,function(e){return N.test(e.href)});var a=B.length;B.push(n),B[a].options=t,[].forEach.call(B[a],function(e,t){var n=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1,l(a),c(t)};_[e]=n,x(e,"click",n)})})}function n(){[].forEach.call(O,function(e){var t=B.length-1;[].forEach.call(B[t],function(e,t){y(e,"click",_[e])}),B.pop()})}function a(){return(j=k("baguetteBox-overlay"))?($=k("baguetteBox-slider"),T=k("previous-button"),D=k("next-button"),void(I=k("close-button"))):(j=C("div"),j.id="baguetteBox-overlay",document.getElementsByTagName("body")[0].appendChild(j),$=C("div"),$.id="baguetteBox-slider",j.appendChild($),T=C("button"),T.id="previous-button",T.innerHTML=z.svg?A:"&lt;",j.appendChild(T),D=C("button"),D.id="next-button",D.innerHTML=z.svg?M:"&gt;",j.appendChild(D),I=C("button"),I.id="close-button",I.innerHTML=z.svg?E:"X",j.appendChild(I),T.className=D.className=I.className="baguetteBox-button",void o())}function i(e){switch(e.keyCode){case 37:h();break;case 39:f();break;case 27:d()}}function o(){x(j,"click",Q),x(T,"click",U),x(D,"click",X),x(I,"click",V),x(j,"touchstart",G),x(j,"touchmove",J),x(j,"touchend",Y)}function r(){y(j,"click",Q),y(T,"click",U),y(D,"click",X),y(I,"click",V),y(j,"touchstart",G),y(j,"touchmove",J),y(j,"touchend",Y)}function l(e){if(q!==e){for(q=e,s(B[e].options);$.firstChild;)$.removeChild($.firstChild);W.length=0;for(var t,n=0;n<B[e].length;n++)t=C("div"),t.className="full-image",t.id="baguette-img-"+n,W.push(t),$.appendChild(W[n])}}function s(e){e||(e={});for(var t in P)H[t]=P[t],"undefined"!=typeof e[t]&&(H[t]=e[t]);$.style.transition=$.style.webkitTransition="fadeIn"===H.animation?"opacity .4s ease":"slideIn"===H.animation?"":"none","auto"===H.buttons&&("ontouchstart"in window||1===B[q].length)&&(H.buttons=!1),T.style.display=D.style.display=H.buttons?"":"none"}function c(e){"block"!==j.style.display&&(x(document,"keydown",i),R=e,u(R,function(){b(R),w(R)}),g(),j.style.display="block",setTimeout(function(){j.className="visible",H.afterShow&&H.afterShow()},50),H.onChange&&H.onChange(R,W.length))}function d(){"none"!==j.style.display&&(y(document,"keydown",i),j.className="",setTimeout(function(){j.style.display="none",H.afterHide&&H.afterHide()},500))}function u(e,t){var n=W[e];if("undefined"!=typeof n){if(n.getElementsByTagName("img")[0])return void(t&&t());imageElement=B[q][e],imageCaption="function"==typeof H.captions?H.captions.call(B[q],imageElement):imageElement.getAttribute("data-caption")||imageElement.title,imageSrc=p(imageElement);var a=C("figure"),i=C("img"),o=C("figcaption");n.appendChild(a),a.innerHTML='<div class="spinner"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>',i.onload=function(){var n=document.querySelector("#baguette-img-"+e+" .spinner");a.removeChild(n),!H.async&&t&&t()},i.setAttribute("src",imageSrc),a.appendChild(i),H.captions&&imageCaption&&(o.innerHTML=imageCaption,a.appendChild(o)),H.async&&t&&t()}}function p(e){var t=imageElement.href;if(e.dataset){var n=[];for(var a in e.dataset)"at-"!==a.substring(0,3)||isNaN(a.substring(3))||(n[a.replace("at-","")]=e.dataset[a]);keys=Object.keys(n).sort(function(e,t){return parseInt(e)<parseInt(t)?-1:1});for(var i=window.innerWidth*window.devicePixelRatio,o=0;o<keys.length-1&&keys[o]<i;)o++;t=n[keys[o]]||t}return t}function f(){var e;return R<=W.length-2?(R++,g(),b(R),e=!0):H.animation&&($.className="bounce-from-right",setTimeout(function(){$.className=""},400),e=!1),H.onChange&&H.onChange(R,W.length),e}function h(){var e;return R>=1?(R--,g(),w(R),e=!0):H.animation&&($.className="bounce-from-left",setTimeout(function(){$.className=""},400),e=!1),H.onChange&&H.onChange(R,W.length),e}function g(){var e=100*-R+"%";"fadeIn"===H.animation?($.style.opacity=0,setTimeout(function(){z.transforms?$.style.transform=$.style.webkitTransform="translate3d("+e+",0,0)":$.style.left=e,$.style.opacity=1},400)):z.transforms?$.style.transform=$.style.webkitTransform="translate3d("+e+",0,0)":$.style.left=e}function v(){var e=C("div");return"undefined"!=typeof e.style.perspective||"undefined"!=typeof e.style.webkitPerspective}function m(){var e=C("div");return e.innerHTML="<svg/>","http://www.w3.org/2000/svg"==(e.firstChild&&e.firstChild.namespaceURI)}function b(e){e-R>=H.preload||u(e+1,function(){b(e+1)})}function w(e){R-e>=H.preload||u(e-1,function(){w(e-1)})}function x(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function y(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)}function k(e){return document.getElementById(e)}function C(e){return document.createElement(e)}function S(){r(),n(),y(document,"keydown",i),document.getElementsByTagName("body")[0].removeChild(document.getElementById("baguetteBox-overlay")),R=0,q=-1,O.length=0,B.length=0}var j,$,T,D,I,F,A='<svg width="44" height="60"><polyline points="30 10 10 30 30 50" stroke="rgba(255,255,255,0.5)" stroke-width="4"stroke-linecap="butt" fill="none" stroke-linejoin="round"/></svg>',M='<svg width="44" height="60"><polyline points="14 10 34 30 14 50" stroke="rgba(255,255,255,0.5)" stroke-width="4"stroke-linecap="butt" fill="none" stroke-linejoin="round"/></svg>',E='<svg width="30" height="30"><g stroke="rgb(160, 160, 160)" stroke-width="4"><line x1="5" y1="5" x2="25" y2="25"/><line x1="5" y1="25" x2="25" y2="5"/></g></svg>',H={},P={captions:!0,buttons:"auto",async:!1,preload:2,animation:"slideIn",afterShow:null,afterHide:null,onChange:null},z={},R=0,q=-1,L=!1,N=/.+\.(gif|jpe?g|png|webp)/i,O=[],B=[],W=[],_={},Q=function(e){e.target&&"IMG"!==e.target.nodeName&&"FIGCAPTION"!==e.target.nodeName&&d()},U=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,h()},X=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,f()},V=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,d()},G=function(e){F=e.changedTouches[0].pageX},J=function(e){L||(e.preventDefault?e.preventDefault():e.returnValue=!1,touch=e.touches[0]||e.changedTouches[0],touch.pageX-F>40?(L=!0,h()):touch.pageX-F<-40&&(L=!0,f()))},Y=function(e){L=!1};return[].forEach||(Array.prototype.forEach=function(e,t){for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)}),[].filter||(Array.prototype.filter=function(e,t,n,a,i){for(n=this,a=[],i=0;i<n.length;i++)e.call(t,n[i],i,n)&&a.push(n[i]);return a}),{run:e,destroy:S,showNext:f,showPrevious:h}}),function(e,t){"function"==typeof define&&define.amd?define("app/scroll",t):"object"==typeof exports?module.exports=t():e.scroll=t()}(this,function(){"use strict";var e={append:function(e,t,n){var a=document.createElement("div"),i=document.createDocumentFragment();a.innerHTML=t;for(var o=0,r=a.children,l=r.length;o<l;o++)i.appendChild(r[o]);return e.appendChild(i),r=null,i=null,a=null,n.apply(e,[]),e},getOffset:function(e){var t=0,n=0;if(e.offsetParent)do t+=e.offsetTop,n+=e.offsetLeft;while(e=e.offsetParent);return{top:t,left:n}},getMousePosition:function(e){var t,n;return e=e||window.event,t=e.pageX||e.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft),n=e.pageY||e.clientY+(document.documentElement.scrollTop||document.body.scrollTop),{positionX:t,positionY:n}},getPrevSibling:function(e){return e.previousElementSibling?e.previousElementSibling:e.previousSibling},setOnselectstart:function(e){document.all?e.returnValue=!1:e.preventDefault(),document.onselectstart=function(){return!1}}},t=function(t){var n=!1,a=document,i=a.getElementById(t.scrollWrap),o=e.append(i,'<div class="l-scroll-btnWrap"><div class="l-scroll-btn"></div></div>',function(){i.className="l-scroll-wrap "+i.className}).lastChild,r=o.lastChild,l=e.getPrevSibling(o),s=i.offsetHeight-2,c=r.offsetHeight,d=s-c,u=l.offsetHeight,p=u-s,f=function(e){r.style.top=e+"px",l.style.marginTop=-(e/d)*p+"px"},h=function(t){var n=e.getMousePosition(t).positionY-e.getOffset(o).top-c/2;f(n>=d?d:n<=1?0:n)},g=function(t){var n,a,i;return t=t||window.event,n=t.wheelDelta||t.detail,a=.1*d,i=r.offsetTop,n==-120||3==n?(i+=a,i=i>=d?d:i):120!=n&&n!=-3||(i-=a,i=i<=1?0:i),f(i),0===i||i===d||(e.setOnselectstart(t),!1)};return l.className="l-scroll-contentWrap "+l.className,l.style.width=i.offsetWidth-15+"px",o.style.height=s+"px",s>u?void(o.style.display="none"):(o.onclick=function(e){h(e)},r.onmousedown=function(t){n=!0,t=t||window.event,e.setOnselectstart(t)},a.onmouseup=function(){n=!1},a.onmousemove=function(e){n&&h(e)},void(void 0===a.onmousewheel?i.addEventListener("DOMMouseScroll",g,!0):i.onmousewheel=g))};return t.prototype.setHeight=function(){},t.prototype.setWidth=function(){},function(e){return e?new t(e):{}}}),define("app/itemhover",["require"],function(e){var t=function(e){var t=$(e.target),n=$(e.title),a=$(e.content),i=e.num?e.num:40;t.hover(function(){var e=$(this),t=e.find(n),o=e.find(a);n.length&&t.animate({bottom:-i},100),o.animate({bottom:"0"},300)},function(){var e=$(this),t=e.find(n),o=e.find(a);n.length&&t.animate({bottom:"0"},300),o.stop().animate({bottom:-i-50},300)})};return function(e){return new t(e)}}),!function(e){e.Jcrop=function(t,n){function a(e){return Math.round(e)+"px"}function i(e){return P.baseClass+"-"+e}function o(){return e.fx.step.hasOwnProperty("backgroundColor")}function r(t){var n=e(t).offset();return[n.left,n.top]}function l(e){return[e.pageX-H[0],e.pageY-H[1]]}function s(t){"object"!=typeof t&&(t={}),P=e.extend(P,t),e.each(["onChange","onSelect","onRelease","onDblClick"],function(e,t){"function"!=typeof P[t]&&(P[t]=function(){})})}function c(e,t,n){if(H=r(W),he.setCursor("move"===e?e:e+"-resize"),"move"===e)return he.activateHandlers(u(t),v,n);var a=ue.getFixed(),i=p(e),o=ue.getCorner(p(i));ue.setPressed(ue.getCorner(i)),ue.setCurrent(o),
he.activateHandlers(d(e,a),v,n)}function d(e,t){return function(n){if(P.aspectRatio)switch(e){case"e":n[1]=t.y+1;break;case"w":n[1]=t.y+1;break;case"n":n[0]=t.x+1;break;case"s":n[0]=t.x+1}else switch(e){case"e":n[1]=t.y2;break;case"w":n[1]=t.y2;break;case"n":n[0]=t.x2;break;case"s":n[0]=t.x2}ue.setCurrent(n),fe.update()}}function u(e){var t=e;return ge.watchKeys(),function(e){ue.moveOffset([e[0]-t[0],e[1]-t[1]]),t=e,fe.update()}}function p(e){switch(e){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function f(e){return function(t){return!P.disabled&&(!("move"===e&&!P.allowMove)&&(H=r(W),ae=!0,c(e,l(t)),t.stopPropagation(),t.preventDefault(),!1))}}function h(e,t,n){var a=e.width(),i=e.height();a>t&&t>0&&(a=t,i=t/e.width()*e.height()),i>n&&n>0&&(i=n,a=n/e.height()*e.width()),te=e.width()/a,ne=e.height()/i,e.width(a).height(i)}function g(e){return{x:e.x*te,y:e.y*ne,x2:e.x2*te,y2:e.y2*ne,w:e.w*te,h:e.h*ne}}function v(){var e=ue.getFixed();e.w>P.minSelect[0]&&e.h>P.minSelect[1]?(fe.enableHandles(),fe.done()):fe.release(),he.setCursor(P.allowSelect?"crosshair":"default")}function m(e){if(!P.disabled&&P.allowSelect){ae=!0,H=r(W),fe.disableHandles(),he.setCursor("crosshair");var t=l(e);return ue.setPressed(t),fe.update(),he.activateHandlers(b,v,"touch"===e.type.substring(0,5)),ge.watchKeys(),e.stopPropagation(),e.preventDefault(),!1}}function b(e){ue.setCurrent(e),fe.update()}function w(){var t=e("<div></div>").addClass(i("tracker"));return R&&t.css({opacity:0,backgroundColor:"white"}),t}function x(e){U.removeClass().addClass(i("holder")).addClass(e)}function y(e,t){function n(){window.setTimeout(b,u)}var a=e[0]/te,i=e[1]/ne,o=e[2]/te,r=e[3]/ne;if(!ie){var l=ue.flipCoords(a,i,o,r),s=ue.getFixed(),c=[s.x,s.y,s.x2,s.y2],d=c,u=P.animationDelay,p=l[0]-c[0],f=l[1]-c[1],h=l[2]-c[2],g=l[3]-c[3],v=0,m=P.swingSpeed;a=d[0],i=d[1],o=d[2],r=d[3],fe.animMode(!0);var b=function(){return function(){v+=(100-v)/m,d[0]=Math.round(a+v/100*p),d[1]=Math.round(i+v/100*f),d[2]=Math.round(o+v/100*h),d[3]=Math.round(r+v/100*g),v>=99.8&&(v=100),100>v?(C(d),n()):(fe.done(),fe.animMode(!1),"function"==typeof t&&t.call(ve))}}();n()}}function k(e){C([e[0]/te,e[1]/ne,e[2]/te,e[3]/ne]),P.onSelect.call(ve,g(ue.getFixed())),fe.enableHandles()}function C(e){ue.setPressed([e[0],e[1]]),ue.setCurrent([e[2],e[3]]),fe.update()}function S(){return g(ue.getFixed())}function j(){return ue.getFixed()}function $(e){s(e),E()}function T(){P.disabled=!0,fe.disableHandles(),fe.setCursor("default"),he.setCursor("default")}function D(){P.disabled=!1,E()}function I(){fe.done(),he.activateHandlers(null,null)}function F(){U.remove(),N.show(),N.css("visibility","visible"),e(t).removeData("Jcrop")}function A(e,t){fe.release(),T();var n=new Image;n.onload=function(){var a=n.width,i=n.height,o=P.boxWidth,r=P.boxHeight;W.width(a).height(i),W.attr("src",e),X.attr("src",e),h(W,o,r),_=W.width(),Q=W.height(),X.width(_).height(Q),le.width(_+2*re).height(Q+2*re),U.width(_).height(Q),pe.resize(_,Q),D(),"function"==typeof t&&t.call(ve)},n.src=e}function M(e,t,n){var a=t||P.bgColor;P.bgFade&&o()&&P.fadeTime&&!n?e.animate({backgroundColor:a},{queue:!1,duration:P.fadeTime}):e.css("backgroundColor",a)}function E(e){P.allowResize?e?fe.enableOnly():fe.enableHandles():fe.disableHandles(),he.setCursor(P.allowSelect?"crosshair":"default"),fe.setCursor(P.allowMove?"move":"default"),P.hasOwnProperty("trueSize")&&(te=P.trueSize[0]/_,ne=P.trueSize[1]/Q),P.hasOwnProperty("setSelect")&&(k(P.setSelect),fe.done(),delete P.setSelect),pe.refresh(),P.bgColor!=se&&(M(P.shade?pe.getShades():U,P.shade?P.shadeColor||P.bgColor:P.bgColor),se=P.bgColor),ce!=P.bgOpacity&&(ce=P.bgOpacity,P.shade?pe.refresh():fe.setBgOpacity(ce)),Y=P.maxSize[0]||0,Z=P.maxSize[1]||0,K=P.minSize[0]||0,ee=P.minSize[1]||0,P.hasOwnProperty("outerImage")&&(W.attr("src",P.outerImage),delete P.outerImage),fe.refresh()}var H,P=e.extend({},e.Jcrop.defaults),z=navigator.userAgent.toLowerCase(),R=/msie/.test(z),q=/msie [1-6]\./.test(z);"object"!=typeof t&&(t=e(t)[0]),"object"!=typeof n&&(n={}),s(n);var L={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},N=e(t),O=!0;if("IMG"==t.tagName){if(0!=N[0].width&&0!=N[0].height)N.width(N[0].width),N.height(N[0].height);else{var B=new Image;B.src=N[0].src,N.width(B.width),N.height(B.height)}var W=N.clone().removeAttr("id").css(L).show();W.width(N.width()),W.height(N.height()),N.after(W).hide()}else W=N.css(L).show(),O=!1,null===P.shade&&(P.shade=!0);h(W,P.boxWidth,P.boxHeight);var _=W.width(),Q=W.height(),U=e("<div />").width(_).height(Q).addClass(i("holder")).css({position:"relative",backgroundColor:P.bgColor}).insertAfter(N).append(W);P.addClass&&U.addClass(P.addClass);var X=e("<div />"),V=e("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),G=e("<div />").width("100%").height("100%").css("zIndex",320),J=e("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var e=ue.getFixed();P.onDblClick.call(ve,e)}).insertBefore(W).append(V,G);O&&(X=e("<img />").attr("src",W.attr("src")).css(L).width(_).height(Q),V.append(X)),q&&J.css({overflowY:"hidden"});var Y,Z,K,ee,te,ne,ae,ie,oe,re=P.boundary,le=w().width(_+2*re).height(Q+2*re).css({position:"absolute",top:a(-re),left:a(-re),zIndex:290}).mousedown(m),se=P.bgColor,ce=P.bgOpacity;H=r(W);var de=function(){function e(){var e,t={},n=["touchstart","touchmove","touchend"],a=document.createElement("div");try{for(e=0;e<n.length;e++){var i=n[e];i="on"+i;var o=i in a;o||(a.setAttribute(i,"return;"),o="function"==typeof a[i]),t[n[e]]=o}return t.touchstart&&t.touchend&&t.touchmove}catch(e){return!1}}function t(){return P.touchSupport===!0||P.touchSupport===!1?P.touchSupport:e()}return{createDragger:function(e){return function(t){return!P.disabled&&(!("move"===e&&!P.allowMove)&&(H=r(W),ae=!0,c(e,l(de.cfilter(t)),!0),t.stopPropagation(),t.preventDefault(),!1))}},newSelection:function(e){return m(de.cfilter(e))},cfilter:function(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e},isSupported:e,support:t()}}(),ue=function(){function e(e){e=r(e),h=p=e[0],g=f=e[1]}function t(e){e=r(e),d=e[0]-h,u=e[1]-g,h=e[0],g=e[1]}function n(){return[d,u]}function a(e){var t=e[0],n=e[1];0>p+t&&(t-=t+p),0>f+n&&(n-=n+f),g+n>Q&&(n+=Q-(g+n)),h+t>_&&(t+=_-(h+t)),p+=t,h+=t,f+=n,g+=n}function i(e){var t=o();switch(e){case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2]}}function o(){if(!P.aspectRatio)return s();var e,t,n,a,i=P.aspectRatio,o=P.minSize[0]/te,r=P.maxSize[0]/te,d=P.maxSize[1]/ne,u=h-p,v=g-f,m=Math.abs(u),b=Math.abs(v),w=m/b;return 0===r&&(r=10*_),0===d&&(d=10*Q),i>w?(t=g,n=b*i,e=0>u?p-n:n+p,0>e?(e=0,a=Math.abs((e-p)/i),t=0>v?f-a:a+f):e>_&&(e=_,a=Math.abs((e-p)/i),t=0>v?f-a:a+f)):(e=h,a=m/i,t=0>v?f-a:f+a,0>t?(t=0,n=Math.abs((t-f)*i),e=0>u?p-n:n+p):t>Q&&(t=Q,n=Math.abs(t-f)*i,e=0>u?p-n:n+p)),e>p?(o>e-p?e=p+o:e-p>r&&(e=p+r),t=t>f?f+(e-p)/i:f-(e-p)/i):p>e&&(o>p-e?e=p-o:p-e>r&&(e=p-r),t=t>f?f+(p-e)/i:f-(p-e)/i),0>e?(p-=e,e=0):e>_&&(p-=e-_,e=_),0>t?(f-=t,t=0):t>Q&&(f-=t-Q,t=Q),c(l(p,f,e,t))}function r(e){return e[0]<0&&(e[0]=0),e[1]<0&&(e[1]=0),e[0]>_&&(e[0]=_),e[1]>Q&&(e[1]=Q),[Math.round(e[0]),Math.round(e[1])]}function l(e,t,n,a){var i=e,o=n,r=t,l=a;return e>n&&(i=n,o=e),t>a&&(r=a,l=t),[i,r,o,l]}function s(){var e,t=h-p,n=g-f;return Y&&Math.abs(t)>Y&&(h=t>0?p+Y:p-Y),Z&&Math.abs(n)>Z&&(g=n>0?f+Z:f-Z),ee/ne&&Math.abs(n)<ee/ne&&(g=n>0?f+ee/ne:f-ee/ne),K/te&&Math.abs(t)<K/te&&(h=t>0?p+K/te:p-K/te),0>p&&(h-=p,p-=p),0>f&&(g-=f,f-=f),0>h&&(p-=h,h-=h),0>g&&(f-=g,g-=g),h>_&&(e=h-_,p-=e,h-=e),g>Q&&(e=g-Q,f-=e,g-=e),p>_&&(e=p-Q,g-=e,f-=e),f>Q&&(e=f-Q,g-=e,f-=e),c(l(p,f,h,g))}function c(e){return{x:e[0],y:e[1],x2:e[2],y2:e[3],w:e[2]-e[0],h:e[3]-e[1]}}var d,u,p=0,f=0,h=0,g=0;return{flipCoords:l,setPressed:e,setCurrent:t,getOffset:n,moveOffset:a,getCorner:i,getFixed:o}}(),pe=function(){function t(e,t){h.left.css({height:a(t)}),h.right.css({height:a(t)})}function n(){return i(ue.getFixed())}function i(e){h.top.css({left:a(e.x),width:a(e.w),height:a(e.y)}),h.bottom.css({top:a(e.y2),left:a(e.x),width:a(e.w),height:a(Q-e.y2)}),h.right.css({left:a(e.x2),width:a(_-e.x2)}),h.left.css({width:a(e.x)})}function o(){return e("<div />").css({position:"absolute",backgroundColor:P.shadeColor||P.bgColor}).appendTo(f)}function r(){p||(p=!0,f.insertBefore(W),n(),fe.setBgOpacity(1,0,1),X.hide(),l(P.shadeColor||P.bgColor,1),fe.isAwake()?c(P.bgOpacity,1):c(1,1))}function l(e,t){M(u(),e,t)}function s(){p&&(f.remove(),X.show(),p=!1,fe.isAwake()?fe.setBgOpacity(P.bgOpacity,1,1):(fe.setBgOpacity(1,1,1),fe.disableHandles()),M(U,0,1))}function c(e,t){p&&(P.bgFade&&!t?f.animate({opacity:1-e},{queue:!1,duration:P.fadeTime}):f.css({opacity:1-e}))}function d(){P.shade?r():s(),fe.isAwake()&&c(P.bgOpacity)}function u(){return f.children()}var p=!1,f=e("<div />").css({position:"absolute",zIndex:240,opacity:0}),h={top:o(),left:o().height(Q),right:o().height(Q),bottom:o()};return{update:n,updateRaw:i,getShades:u,setBgColor:l,enable:r,disable:s,resize:t,refresh:d,opacity:c}}(),fe=function(){function t(t){var n=e("<div />").css({position:"absolute",opacity:P.borderOpacity}).addClass(i(t));return V.append(n),n}function n(t,n){var a=e("<div />").mousedown(f(t)).css({cursor:t+"-resize",position:"absolute",zIndex:n}).addClass("ord-"+t);return de.support&&a.bind("touchstart.jcrop",de.createDragger(t)),G.append(a),a}function o(e){var t=P.handleSize,a=n(e,T++).css({opacity:P.handleOpacity}).addClass(i("handle"));return t&&a.width(t).height(t),a}function r(e){return n(e,T++).addClass("jcrop-dragbar")}function l(e){var t;for(t=0;t<e.length;t++)F[e[t]]=r(e[t])}function s(e){var n,a;for(a=0;a<e.length;a++){switch(e[a]){case"n":n="hline";break;case"s":n="hline bottom";break;case"e":n="vline right";break;case"w":n="vline"}D[e[a]]=t(n)}}function c(e){var t;for(t=0;t<e.length;t++)I[e[t]]=o(e[t])}function d(e,t){P.shade||X.css({top:a(-t),left:a(-e)}),J.css({top:a(t),left:a(e)})}function u(e,t){J.width(Math.round(e)).height(Math.round(t))}function p(){var e=ue.getFixed();ue.setPressed([e.x,e.y]),ue.setCurrent([e.x2,e.y2]),h()}function h(e){return $?v(e):void 0}function v(e){var t=ue.getFixed();u(t.w,t.h),d(t.x,t.y),P.shade&&pe.updateRaw(t),$||b(),e?P.onSelect.call(ve,g(t)):P.onChange.call(ve,g(t))}function m(e,t,n){($||t)&&(P.bgFade&&!n?W.animate({opacity:e},{queue:!1,duration:P.fadeTime}):W.css("opacity",e))}function b(){J.show(),P.shade?pe.opacity(ce):m(ce,!0),$=!0}function x(){C(),J.hide(),P.shade?pe.opacity(1):m(1),$=!1,P.onRelease.call(ve)}function y(){A&&G.show()}function k(){return A=!0,P.allowResize?(G.show(),!0):void 0}function C(){A=!1,G.hide()}function S(e){e?(ie=!0,C()):(ie=!1,k())}function j(){S(!1),p()}var $,T=370,D={},I={},F={},A=!1;P.dragEdges&&e.isArray(P.createDragbars)&&l(P.createDragbars),e.isArray(P.createHandles)&&c(P.createHandles),P.drawBorders&&e.isArray(P.createBorders)&&s(P.createBorders),e(document).bind("touchstart.jcrop-ios",function(t){e(t.currentTarget).hasClass("jcrop-tracker")&&t.stopPropagation()});var M=w().mousedown(f("move")).css({cursor:"move",position:"absolute",zIndex:360});return de.support&&M.bind("touchstart.jcrop",de.createDragger("move")),V.append(M),C(),{updateVisible:h,update:v,release:x,refresh:p,isAwake:function(){return $},setCursor:function(e){M.css("cursor",e)},enableHandles:k,enableOnly:function(){A=!0},showHandles:y,disableHandles:C,animMode:S,setBgOpacity:m,done:j}}(),he=function(){function t(t){le.css({zIndex:450}),t?e(document).bind("touchmove.jcrop",r).bind("touchend.jcrop",s):p&&e(document).bind("mousemove.jcrop",a).bind("mouseup.jcrop",i)}function n(){le.css({zIndex:290}),e(document).unbind(".jcrop")}function a(e){return d(l(e)),!1}function i(e){return e.preventDefault(),e.stopPropagation(),ae&&(ae=!1,u(l(e)),fe.isAwake()&&P.onSelect.call(ve,g(ue.getFixed())),n(),d=function(){},u=function(){}),!1}function o(e,n,a){return ae=!0,d=e,u=n,t(a),!1}function r(e){return d(l(de.cfilter(e))),!1}function s(e){return i(de.cfilter(e))}function c(e){le.css("cursor",e)}var d=function(){},u=function(){},p=P.trackDocument;return p||le.mousemove(a).mouseup(i).mouseout(i),W.before(le),{activateHandlers:o,setCursor:c}}(),ge=function(){function t(){P.keySupport&&(o.show(),o.focus())}function n(){o.hide()}function a(e,t,n){P.allowMove&&(ue.moveOffset([t,n]),fe.updateVisible(!0)),e.preventDefault(),e.stopPropagation()}function i(e){if(e.ctrlKey||e.metaKey)return!0;oe=!!e.shiftKey;var t=oe?10:1;switch(e.keyCode){case 37:a(e,-t,0);break;case 39:a(e,t,0);break;case 38:a(e,0,-t);break;case 40:a(e,0,t);break;case 27:P.allowSelect&&fe.release();break;case 9:return!0}return!1}var o=e('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),r=e("<div />").css({position:"absolute",overflow:"hidden"}).append(o);return P.keySupport&&(o.keydown(i).blur(n),q||!P.fixedSupport?(o.css({position:"absolute",left:"-20px"}),r.append(o).insertBefore(W)):o.insertBefore(W)),{watchKeys:t}}();de.support&&le.bind("touchstart.jcrop",de.newSelection),G.hide(),E(!0);var ve={setImage:A,animateTo:y,setSelect:k,setOptions:$,tellSelect:S,tellScaled:j,setClass:x,disable:T,enable:D,cancel:I,release:fe.release,destroy:F,focus:ge.watchKeys,getBounds:function(){return[_*te,Q*ne]},getWidgetSize:function(){return[_,Q]},getScaleFactor:function(){return[te,ne]},getOptions:function(){return P},ui:{holder:U,selection:J}};return R&&U.bind("selectstart",function(){return!1}),N.data("Jcrop",ve),ve},e.fn.Jcrop=function(t,n){var a;return this.each(function(){if(e(this).data("Jcrop")){if("api"===t)return e(this).data("Jcrop");e(this).data("Jcrop").setOptions(t)}else"IMG"==this.tagName?e.Jcrop.Loader(this,function(){e(this).css({display:"block",visibility:"hidden"}),a=e.Jcrop(this,t),e.isFunction(n)&&n.call(a)}):(e(this).css({display:"block",visibility:"hidden"}),a=e.Jcrop(this,t),e.isFunction(n)&&n.call(a))}),this},e.Jcrop.Loader=function(t,n,a){function i(){r.complete?(o.unbind(".jcloader"),e.isFunction(n)&&n.call(r)):window.setTimeout(i,50)}var o=e(t),r=o[0];o.bind("load.jcloader",i).bind("error.jcloader",function(){o.unbind(".jcloader"),e.isFunction(a)&&a.call(r)}),r.complete&&e.isFunction(n)&&(o.unbind(".jcloader"),n.call(r))},e.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}}(jQuery),define("app/jcrop/jquery.Jcrop.min",function(){}),function(e,t){"function"==typeof define&&define.amd?define("app/jquery.suggestion",t):"object"==typeof exports?module.exports=t():e.suggestion=t()}(this,function(){var e=null,t=function(e,t,n){var a=e.width,i=e.pregKind,o=e.ajax,r=e.isTouchRequest,l=[],s=[],c=!0,d=e.initValue?e.initValue:"",u=t.attr("name"),p=t.outerHeight(),f=a?a:t.outerWidth(),h=e.name.length&&e.name[n]?e.name[n]:u+"Hidden";"undefined"==typeof e.name?h=u+"Hidden":"string"==typeof e.name?h=e.name:"object"==typeof e.name&&(h=e.name[n]?e.name[n]:u+"Hidden");var g=e.value.length&&e.value[n]?e.value[n]:"",v=t.wrap('<div class="l-suggestion fn-left"></div>').parent().append('<input type="hidden" name="'+h+'" value="'+g+'" /><ul class="l-suggestion-list" data-index="0" style="display:none"></ul>'),m=v.find(".l-suggestion-list"),b=v.find("input:hidden"),w=function(e){var t="",n=null,a="",i="",o="",r="";s=e;for(var l=0,c=e.length;l<c&&l<10;l++)n=e[l],a=n.nation?"("+n.nation+")":"",i=n.name?n.name:"",o=n.letter?n.letter:"",r=n.id?n.id:"",t+='<li class="fn-clear" data-index="'+l+'" data-id="'+r+'"><span class="fn-left">'+n.name+a+'</span><span class="fn-right">'+o+"</span></li>";m.css({top:p+"px",width:f-2+"px",zIndex:2}).html(t)},x=function(e){var t=m.find("li"),n=t.length;if(e){var a=m.attr("data-index")==n?0:m.attr("data-index");t.eq(a).addClass("cur"),a++,m.attr("data-index",a)}else{var a=0==m.attr("data-index")?n:m.attr("data-index");a--,t.eq(a).addClass("cur"),m.attr("data-index",a)}},y=function(e){var t=$(e.currentTarget),n=t.val(),a=e.keyCode,o=0,s=[],c=null,d="";if(r)s=l;else for(var u=0,p=l.length;u<p;u++)c=l[u],d=(c.name?c.name:"")+(c.letter?c.letter:"")+(c.nation?c.nation:""),d.toLocaleLowerCase().indexOf(n.toLocaleLowerCase())!==-1&&1===i&&s.push(c),0===d.toLocaleLowerCase().indexOf(n.toLocaleLowerCase())&&2===i&&s.push(c);switch(w(s),m.show(),a){case 40:x(!0),e.preventDefault();break;case 38:x(!1),e.preventDefault();break;case 13:o=m.attr("data-index"),o=o>0?o-1:0,C(s[o],t),e.preventDefault(),k();break;default:m.attr("data-index",0)}},k=function(){m.hide().html("").attr("index",0).css({zIndex:1}),c=!0},C=function(n,a){b.val(n.id),a.val(n.name?n.name:""),e.touch.apply(t,[n,t,b]),!n.name},S=function(e,n){r?(o.data||(o.data={}),o.data.keyword=t.val(),$.ajax({type:o.type,url:o.url,cache:!1,dataType:"json",data:o.data,beforeSend:function(){},success:function(e){n(),l=e,w(e)},error:function(e){}})):!e&&o?l.length||$.ajax({type:o.type,url:o.url,cache:!1,dataType:"json",data:o.data,beforeSend:function(){},success:function(e){l=e,w(e)},error:function(e){}}):(l=e,w(e))};t.attr("autocomplete","off").off().on("focus",function(t){return r?void S(e.data,function(){y(t)}):(S(e.data),void y(t))}).on("blur",function(){c&&k(),e.isResultNullBlurClear&&(s.length?b.val()||(t.val(""),e.blurClear.apply(t,[t,b])):(t.val(""),b.val(""),e.blurClear.apply(t,[t,b])))}).on("keyup",function(n){var a=n.keyCode;return r?void(40!==a&&38!==a&&13!==a?S(e.data,function(){y(n)}):y(n)):(t.val()||b.val(""),8===a&&b.val(""),void y(n))}),d&&t.val(d),m.off().on("click","li",function(n){var a=m.attr("data-index");C(s[a],t),n.preventDefault(),e.autoClose||t.trigger("focus").trigger("blur"),k()}).on("mouseover","li",function(){var e=$(this);e.addClass("cur"),c=!1,m.attr("data-index",e.attr("data-index"))}).on("mouseout","li",function(){var e=$(this);e.removeClass("cur"),c=!0,m.attr("data-index",e.attr("data-index"))})};$.fn.refreshSuggestion=function(){this.each(function(){t(e,$(this))})},$.fn.suggestion=function(n){e=$.extend({},{data:null,width:0,pregKind:1,name:[],value:[],ajax:{url:"",type:"GET",data:{},success:function(){}},isTouchRequest:!1,isResultNullBlurClear:!0,touch:function(){},blurClear:function(){}},n),this.each(function(n){t(e,$(this),n)})}}),function(e,t){"function"==typeof define&&define.amd?define("app/ajaxfileupload",t):"object"==typeof exports?module.exports=t():e.suggestion=t()}(this,function(){jQuery.extend({createUploadIframe:function(e,t){var n="jUploadFrame"+e,a='<iframe id="'+n+'" name="'+n+'" style="position:absolute; top:-9999px; left:-9999px"';return window.ActiveXObject&&("boolean"==typeof t?a+=' src="javascript:false"':"string"==typeof t&&(a+=' src="'+t+'"')),a+=" />",jQuery(a).appendTo(document.body),jQuery("#"+n).get(0)},createUploadForm:function(e,t,n){var a="jUploadForm"+e,i="jUploadFile"+e,o=jQuery('<form  action="" method="POST" name="'+a+'" id="'+a+'" enctype="multipart/form-data"></form>');if(n)for(var r in n)jQuery('<input type="hidden" name="'+r+'" value="'+n[r]+'" />').appendTo(o);var l=jQuery("#"+t),s=jQuery(l).clone();return jQuery(l).attr("id",i),jQuery(l).before(s),jQuery(l).appendTo(o),jQuery(o).css("position","absolute"),jQuery(o).css("top","-1200px"),jQuery(o).css("left","-1200px"),jQuery(o).appendTo("body"),o},ajaxFileUpload:function(e){e=jQuery.extend({},jQuery.ajaxSettings,e);var t=(new Date).getTime(),n=jQuery.createUploadForm(t,e.fileElementId,"undefined"!=typeof e.data&&e.data),a=(jQuery.createUploadIframe(t,e.secureuri),"jUploadFrame"+t),i="jUploadForm"+t;e.global&&!jQuery.active++&&jQuery.event.trigger("ajaxStart");var o=!1,r={};e.global&&jQuery.event.trigger("ajaxSend",[r,e]);var l=function(t){var i=document.getElementById(a);try{i.contentWindow?(r.responseText=i.contentWindow.document.body?i.contentWindow.document.body.innerHTML:null,r.responseXML=i.contentWindow.document.XMLDocument?i.contentWindow.document.XMLDocument:i.contentWindow.document):i.contentDocument&&(r.responseText=i.contentDocument.document.body?i.contentDocument.document.body.innerHTML:null,r.responseXML=i.contentDocument.document.XMLDocument?i.contentDocument.document.XMLDocument:i.contentDocument.document)}catch(t){jQuery.handleError(e,r,null,t)}if(r||"timeout"==t){o=!0;var l;try{if(l="timeout"!=t?"success":"error","error"!=l){var s=jQuery.uploadHttpData(r,e.dataType);e.success&&e.success(s,l),e.global&&jQuery.event.trigger("ajaxSuccess",[r,e])}else jQuery.handleError(e,r,l)}catch(t){l="error",jQuery.handleError(e,r,l,t)}e.global&&jQuery.event.trigger("ajaxComplete",[r,e]),e.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop"),e.complete&&e.complete(r,l),jQuery(i).unbind(),setTimeout(function(){try{jQuery(i).remove(),jQuery(n).remove()}catch(t){jQuery.handleError(e,r,null,t)}},100),r=null}};e.timeout>0&&setTimeout(function(){o||l("timeout")},e.timeout);try{var n=jQuery("#"+i);jQuery(n).attr("action",e.url),jQuery(n).attr("method","POST"),jQuery(n).attr("target",a),n.encoding?jQuery(n).attr("encoding","multipart/form-data"):jQuery(n).attr("enctype","multipart/form-data"),jQuery(n).submit()}catch(t){jQuery.handleError(e,r,null,t)}return jQuery("#"+a).load(l),{abort:function(){}}},uploadHttpData:function(r,type){var data=!type;return data="xml"==type||data?r.responseXML:r.responseText,"script"==type&&jQuery.globalEval(data),"json"==type&&eval("data = "+data),"html"==type&&jQuery("<div>").html(data).evalScripts(),data}})}),function(e,t){"function"==typeof define&&define.amd?define("app/selectArea",["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):e.SelectArea=t(e.jQuery)}(this,function(e){"use strict";var t=function(t){var n=this,a={lastData:[],selectedData:[]},i={selected:'<span class="l-selectArea-selectedItem" data-id="{{id}}">{{name}}<span>x</span></span>',option:'<option value="{{id}}" data-index="{{index}}">{{name}}</option>',radio:'<label><input type="radio" class="ui-radio" id="{{id}}" value="{{name}}" {{checked}} /><i class="ui-label ui-radio-label">{{name}}</i></label>',checkbox:'<label><input type="checkbox" class="ui-checkbox" id="{{id}}" value="{{name}}" {{checked}} /><i class="ui-label ui-checkbox-label">{{name}}</i></label>',search:'<div class="l-selectArea-search ui-form"><label><input type="text" class="ui-input" /></label><span class="ui-btn">搜索</span></div>',nullText:'<div class="l-selectArea-nullText">暂无数据</div>'},o={fnClose:function(){var e=n.wrap,t=e.find(".l-selectAreaMain"),a=e.find(".l-selectArea-close"),i=e.find(".l-selectArea-open");a.on("click",function(){t.hide(),i.show()}),i.on("click",function(){t.show(),i.hide()})},fnRemove:function(){var t=n.wrap,i=n.target,r=t.find('input[type="checkbox"]');t.find(".l-selectArea-selected");t.off("click",".l-selectArea-selectedItem").on("click",".l-selectArea-selectedItem",function(){var t=e(this),n=t.attr("data-id"),l=r.filter(function(){return this.id===n});l.prop("checked",!1),t.remove(),o.removeSelectedData(n),o.removeFlagSelectedData(n),i.val(o.getSelectIDs(a.selectedData))})},fnClick:function(){var t=n.wrap,r=n.target,l=t.find(".l-selectArea-selected");t.off("change",'input[type="checkbox"]').on("change",'input[type="checkbox"]',function(){var t=e(this),n=t[0].checked,s=t.val(),c=this.id,d=!1,u=a.selectedData.length;if(n){for(var p=0;p<u;p++)c!==a.selectedData[p].id&&(d=!0);u&&!d||a.selectedData.push({name:s,id:c}),console.log(c,a.selectedData[p].id,u)}else o.removeSelectedData(c),o.removeFlagSelectedData(c);r.val(o.getSelectIDs(a.selectedData)),l.html(o._each(i.selected,a.selectedData))})},fnSearch:function(){var e=(n.data,n.wrap),t=(n.target,e.find(".l-selectArea-search")),r=e.find(".l-selectArea-scenery");e.off("click",".ui-btn").on("click",".ui-btn",function(){for(var l=a.lastData,s=l?l.length:0,c=0,d=!1,u=[],p=t.find("input"),f=p.val(),h=new RegExp((f?f:"").toLowerCase()),g=null,v="",m=e.find(".l-selectArea-city option:selected").attr("data-index"),b=[];c<s;c++)g=h.test((l[c].name?l[c].name+"":"").toLowerCase()),d=!1,g&&u.push(l[c]);u.length?(u=o.flagSelectedData(u),2===n.type&&(b=[{name:n.data[m].name,id:n.data[m].id}],b=o.flagSelectedData(b),v='<div class="l-selectArea-sceneryHeader ui-form">'+o._each(i.checkbox,b)+"</div>"),v+='<div class="l-selectArea-sceneryMain ui-form">'+o._each(i.checkbox,u)+"</div>"):v=o._tpl(i.nullText),r.html(v)})},fnSelect:function(){var t=n.data,r=n.wrap,l=(n.target,r.find(".l-selectArea-city"),r.find(".l-selectArea-county")),s=r.find(".l-selectArea-scenery");r.off("change",".l-selectArea-city").on("change",".l-selectArea-city",function(){var r=e(this),c=r.find("option:selected"),d=c.attr("data-index"),u=t[d].children,p="",f="";a.lastData=o.flagSelectedData(u),1===n.type?l.attr("data-index",d).html(o._each(i.option,a.lastData)).trigger("change"):2===n.type?(p=[{name:t[d].name,id:t[d].id}],p=o.flagSelectedData(p),f='<div class="l-selectArea-sceneryHeader ui-form">'+o._each(i.checkbox,p)+'</div><div class="l-selectArea-sceneryMain ui-form">'+o._each(i.checkbox,a.lastData)+"</div>",s.html(f)):(f='<div class="l-selectArea-sceneryMain ui-form">'+o._each(i.checkbox,a.lastData)+"</div>",s.html(f))}),1===n.type&&r.off("change",".l-selectArea-county").on("change",".l-selectArea-county",function(){var n=e(this),r=n.attr("data-index"),l=n.find("option:selected"),c=l.attr("data-index"),d=t[r].children[c].children;d?(a.lastData=o.flagSelectedData(d),s.html('<div class="l-selectArea-sceneryMain ui-form">'+o._each(i.checkbox,a.lastData)+"</div>")):s.html(o._tpl(i.nullText))})},getSelectIDs:function(e){for(var t=[],n=0,a=e.length;n<a;n++)t.push(e[n].id);return t.join(",")},removeSelectedData:function(e){for(var t=0,n=a.selectedData.length;t<n;t++)a.selectedData[t]&&e===a.selectedData[t].id&&a.selectedData.splice(t,1)},removeFlagSelectedData:function(e){for(var t=a.selectedData,n=a.lastData,i=t.length,o=0,r=n.length;o<r;o++)if(i)for(var l=0;l<i;l++)n[o].id===e&&delete n[o].checked;else delete n[o].checked},flagSelectedData:function(e){for(var t=a.selectedData,n=e?e.length:0,i=0,o=t.length;i<o;i++)for(var r=0;r<n;r++)e[r].id===t[i].id&&(e[r].checked="checked");return e},_tpl:function(e,t){return e.replace(/{{(.*?)}}/g,function(e,n){return void 0===t[n]?"":t[n]})},_each:function(e,t){for(var n="",a=0,i=t?t.length:0;a<i;a++)t[a].index=a,n+=o._tpl(e,t[a]);return n},init:function(){var t=n.data,r=n.wrap,l=n.target,s="",c="",d="",u="",p="",f="",h="";return a.lastData=t[0].children,s=o._each(i.option,t),s='<select class="l-selectArea-city ui-select">'+s+"</select>",1===n.type?(d=o._each(i.option,t[0].children),d='<select class="l-selectArea-county ui-select ui-select-mid" data-index="0">'+d+"</select>",a.lastData=t[0].children[0].children):2===n.type&&(c=[{name:t[0].name,id:t[0].id}],c=o.flagSelectedData(c),c='<div class="l-selectArea-sceneryHeader ui-form">'+o._each(i.checkbox,c)+"</div>"),u=o._each(i.checkbox,o.flagSelectedData(a.lastData)),u='<div class="l-selectArea-scenery">'+c+'<div class="l-selectArea-sceneryMain ui-form">'+u+"</div></div>",p='<div class="l-selectArea-selected">'+(a.selectedData&&o._each(i.selected,a.selectedData))+"</div>",h+='<div class="l-selectArea-selectedWrap">'+p+'<span class="l-selectArea-open ui-btn">请选择</span></div><div class="l-selectAreaMain"><div class="l-selectAreaWrap"><div class="l-selectAreaHeader"><div class="ui-form">'+s+d+"</div>"+i.search+"</div>"+u+'</div><div class="l-selectAreaCenter"><span class="ui-label">其他景点：</span><label><input type="text" class="ui-input otherSence" value=""></label></div><div class="l-selectAreaBottom"><span class="l-selectArea-close ui-btn">确定</span></div></div>',f+='<div class="l-selectArea-selectedWrap">'+p+'<span class="l-selectArea-open ui-btn">请选择</span></div><div class="l-selectAreaMain"><div class="l-selectAreaWrap"><div class="l-selectAreaHeader"><div class="ui-form">'+s+d+"</div>"+i.search+"</div>"+u+'</div><div class="l-selectAreaBottom"><span class="l-selectArea-close ui-btn">确定</span></div></div>',n.isOtherSence?(r.html(h),e(".otherSence").val(n.otherSence)):r.html(f),o.fnClick(),o.fnSelect(),o.fnSearch(),o.fnRemove(),o.fnClose(),l.val(o.getSelectIDs(a.selectedData)),o}};n.data=t.data?t.data:[],n.target=e(t.target),n.wrap=e(t.wrap),n.type=void 0!==t.type?t.type:1,a.selectedData=t.selectedData?t.selectedData:[],n.otherSence=t.otherSence?t.otherSence:"",n.isOtherSence=!!t.hasOwnProperty("otherSence"),n.run=o.init};return t.prototype={constructor:t,getData:function(t){var n=this,a=t.url,i=t.type?t.type:"POST";e.ajax({type:i,url:a,cache:!1,dataType:"json",beforeSend:function(){},success:function(e){n.data=e,n.run()},error:function(e){console.log(e)}})},reload:function(){}},function(e){return e?new t(e):{}}}),define("app/main",["require","app/cncnERP","app/common","app/anchorChain","app/wordsNumber","app/baguetteBox","app/scroll","app/itemhover","app/jcrop/jquery.Jcrop.min","app/jquery.suggestion","app/ajaxfileupload","app/selectArea"],function(e){var t=e("app/cncnERP");return e("app/common"),e("app/anchorChain"),e("app/wordsNumber"),t.ui.baguetteBox=e("app/baguetteBox"),t.ui.scroll=e("app/scroll"),t.ui.itemHover=e("app/itemhover"),e("app/jcrop/jquery.Jcrop.min"),e("app/jquery.suggestion"),e("app/ajaxfileupload"),t.ui.selectArea=e("app/selectArea"),t});